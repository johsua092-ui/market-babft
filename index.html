<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OXYX MARKET - FIXED</title>
    <script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        body {
            background: #0a0a0a;
            color: white;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #b300ff;
            font-size: 3em;
        }
        
        .discord-links {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }
        
        .discord-btn {
            padding: 10px 20px;
            background: #5865F2;
            color: white;
            text-decoration: none;
            border-radius: 5px;
        }
        
        .card {
            background: #1a1a2a;
            border: 2px solid #b300ff;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .device-info {
            background: #0a0a1a;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .device-id {
            color: #00ff00;
            font-family: monospace;
            word-break: break-all;
        }
        
        .auth-section {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        
        .auth-section input {
            flex: 1;
            padding: 12px;
            background: #2a2a3a;
            border: 2px solid #b300ff;
            border-radius: 5px;
            color: white;
        }
        
        button {
            padding: 12px 25px;
            background: #b300ff;
            border: none;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }
        
        button:hover {
            background: #d400ff;
        }
        
        .user-info {
            background: #1a1a2a;
            border: 2px solid gold;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .role-badge {
            background: gold;
            color: black;
            padding: 5px 15px;
            border-radius: 20px;
        }
        
        .chat-box {
            background: #0a0a1a;
            border: 2px solid #b300ff;
            border-radius: 5px;
            padding: 15px;
            height: 150px;
            overflow-y: auto;
            margin: 10px 0;
        }
        
        .chat-message {
            padding: 5px;
            border-bottom: 1px solid #333;
        }
        
        .owner-text { color: gold; }
        .mod-text { color: #00ff00; }
        
        .form-group {
            margin: 15px 0;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            background: #2a2a3a;
            border: 2px solid #b300ff;
            border-radius: 5px;
            color: white;
        }
        
        .marketplace-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .build-card {
            background: #2a2a3a;
            border: 2px solid #b300ff;
            border-radius: 5px;
            padding: 15px;
        }
        
        .build-price {
            color: gold;
            font-size: 1.2em;
            margin: 10px 0;
        }
        
        .download-btn {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background: #00aa00;
        }
        
        .delete-btn {
            width: 100%;
            padding: 10px;
            background: #aa0000;
        }
        
        .hidden {
            display: none !important;
        }
        
        .footer {
            text-align: center;
            color: #666;
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ö° OXYX MARKET ‚ö°</h1>
        </div>

        <div class="discord-links">
            <a href="#" class="discord-btn">MAIN SERVER</a>
            <a href="#" class="discord-btn">TRADE SERVER</a>
            <a href="#" class="discord-btn">BUILDER SERVER</a>
        </div>

        <div class="card">
            <h2>üîê DEVICE FINGERPRINT</h2>
            <div class="device-info">
                <div>üñ•Ô∏è Device ID: <span class="device-id" id="deviceId">Loading...</span></div>
                <div>üìç IP Address: <span id="ipAddress">Detecting...</span></div>
            </div>
        </div>

        <div class="card">
            <h2>üîê MEMBER ACCESS</h2>
            
            <div class="auth-section">
                <input type="text" id="memberUsername" placeholder="Enter username">
                <button onclick="loginMember()">LOGIN</button>
            </div>
            
            <div class="auth-section">
                <input type="text" id="adminUser" placeholder="Admin">
                <input type="password" id="adminPass" placeholder="Password">
                <button onclick="loginAdmin()">ADMIN</button>
            </div>
            
            <div id="userInfo" class="user-info hidden">
                <span id="displayName"></span>
                <span class="role-badge" id="displayRole"></span>
                <button onclick="logout()">LOGOUT</button>
            </div>
        </div>

        <div id="chatSection" class="card hidden">
            <h2>üí¨ MOD CHAT</h2>
            <div class="chat-box" id="chatMessages"></div>
            <div style="display: flex; gap: 10px;">
                <input type="text" id="chatInput" placeholder="Type..." style="flex: 1; padding: 10px; background:#2a2a3a; border:2px solid #b300ff; color:white;">
                <button onclick="sendChat()">SEND</button>
            </div>
        </div>

        <div id="uploadSection" class="card hidden">
            <h2>üì§ UPLOAD BUILD</h2>
            <div class="form-group">
                <label>Title</label>
                <input type="text" id="buildTitle">
            </div>
            <div class="form-group">
                <label>Game</label>
                <select id="buildGame">
                    <option>Blox Fruits</option>
                    <option>GPO</option>
                    <option>Build A Boat</option>
                </select>
            </div>
            <div class="form-group">
                <label>Price</label>
                <input type="text" id="buildPrice">
            </div>
            <div class="form-group">
                <label>Description</label>
                <textarea id="buildDesc"></textarea>
            </div>
            <div class="form-group">
                <label>File (.build)</label>
                <input type="file" id="buildFile" accept=".build">
            </div>
            <button onclick="uploadBuild()">UPLOAD</button>
        </div>

        <div class="card">
            <h2>üè™ MARKETPLACE</h2>
            <div style="display: flex; gap: 10px; margin: 15px 0;">
                <button onclick="filterBuilds('All')">ALL</button>
                <button onclick="filterBuilds('Blox Fruits')">BLOX</button>
                <button onclick="filterBuilds('GPO')">GPO</button>
                <button onclick="filterBuilds('Build A Boat')">BOAT</button>
                <button onclick="filterBuilds('My Builds')">MY</button>
            </div>
            <div class="marketplace-grid" id="marketplace"></div>
        </div>

        <div class="footer">
            <p>OXYX MARKET ‚Ä¢ 1 Device Only ‚Ä¢ Real Tracking</p>
        </div>
    </div>

    <script>
        // ========== DATA REAL ==========
        let currentUser = null;
        let currentFilter = 'All';
        let deviceId = 'unknown';
        let clientIP = 'unknown';
        
        let builds = [
            { id: 1, title: "Dragon Sword", game: "Blox Fruits", price: "Free", desc: "Auto farm", file: "dragon.build", seller: "owner" },
            { id: 2, title: "Sea King", game: "GPO", price: "$5", desc: "Farm sea king", file: "sea.build", seller: "mod1" }
        ];
        
        let chats = [
            { user: "owner", role: "owner", msg: "Welcome!" }
        ];

        // ========== FINGERPRINT REAL ==========
        async function initFingerprint() {
            try {
                const fp = await FingerprintJS.load();
                const result = await fp.get();
                deviceId = result.visitorId;
                document.getElementById('deviceId').textContent = deviceId;
                
                const res = await fetch('https://api.ipify.org?format=json');
                const data = await res.json();
                clientIP = data.ip;
                document.getElementById('ipAddress').textContent = clientIP;
            } catch (e) {
                console.log('Error:', e);
            }
        }

        // ========== AUTH REAL ==========
        window.loginMember = function() {
            const username = document.getElementById('memberUsername').value.trim();
            if (!username) return alert('Enter username!');
            
            currentUser = { username: username, role: 'member' };
            document.getElementById('userInfo').classList.remove('hidden');
            document.getElementById('displayName').textContent = `üî• ${username}`;
            document.getElementById('displayRole').textContent = 'MEMBER';
            document.getElementById('uploadSection').classList.remove('hidden');
            alert(`‚úÖ Welcome ${username}!`);
        }

        window.loginAdmin = function() {
            const user = document.getElementById('adminUser').value;
            const pass = document.getElementById('adminPass').value;
            
            if (user === 'owner' && pass === 'owner_oxyx_2026') {
                currentUser = { username: 'owner', role: 'owner' };
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('displayName').textContent = 'üëë owner';
                document.getElementById('displayRole').textContent = 'OWNER';
                document.getElementById('uploadSection').classList.remove('hidden');
                document.getElementById('chatSection').classList.remove('hidden');
                alert('‚úÖ Welcome OWNER!');
            } 
            else if ((user === 'mod1' || user === 'mod2') && pass === 'mod123') {
                currentUser = { username: user, role: 'moderator' };
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('displayName').textContent = `üõ°Ô∏è ${user}`;
                document.getElementById('displayRole').textContent = 'MODERATOR';
                document.getElementById('uploadSection').classList.remove('hidden');
                document.getElementById('chatSection').classList.remove('hidden');
                alert(`‚úÖ Welcome ${user}!`);
            }
            else {
                alert('‚ùå Wrong credentials!');
            }
        }

        window.logout = function() {
            currentUser = null;
            document.getElementById('userInfo').classList.add('hidden');
            document.getElementById('uploadSection').classList.add('hidden');
            document.getElementById('chatSection').classList.add('hidden');
            alert('üëã Logged out');
        }

        // ========== CHAT ==========
        window.sendChat = function() {
            if (!currentUser || currentUser.role === 'member') {
                return alert('Only mods can chat!');
            }
            
            const msg = document.getElementById('chatInput').value.trim();
            if (!msg) return;
            
            chats.push({ 
                user: currentUser.username, 
                role: currentUser.role, 
                msg: msg 
            });
            
            displayChat();
            document.getElementById('chatInput').value = '';
        }

        function displayChat() {
            const box = document.getElementById('chatMessages');
            box.innerHTML = chats.map(c => 
                `<div class="chat-message">
                    <span class="${c.role}-text">${c.role === 'owner' ? 'üëë' : 'üõ°Ô∏è'} ${c.user}:</span> ${c.msg}
                </div>`
            ).join('');
        }

        // ========== UPLOAD ==========
        window.uploadBuild = function() {
            if (!currentUser) return alert('Login first!');
            
            const title = document.getElementById('buildTitle').value.trim();
            const game = document.getElementById('buildGame').value;
            const price = document.getElementById('buildPrice').value.trim();
            const desc = document.getElementById('buildDesc').value.trim();
            const file = document.getElementById('buildFile').files[0];
            
            if (!title || !desc || !file) return alert('Fill all!');
            
            builds.push({
                id: Date.now(),
                title: title,
                game: game,
                price: price,
                desc: desc,
                file: file.name,
                seller: currentUser.username
            });
            
            alert('‚úÖ Uploaded!');
            displayMarketplace();
        }

        // ========== DOWNLOAD ==========
        window.downloadBuild = function(id, filename) {
            alert(`üì• Downloading ${filename}...`);
        }

        window.deleteBuild = function(id) {
            if (!currentUser) return alert('Login first!');
            
            const build = builds.find(b => b.id === id);
            if (!build) return;
            
            if (currentUser.role !== 'owner' && currentUser.role !== 'moderator' && build.seller !== currentUser.username) {
                return alert('No permission!');
            }
            
            builds = builds.filter(b => b.id !== id);
            alert('‚úÖ Deleted!');
            displayMarketplace();
        }

        // ========== FILTER ==========
        window.filterBuilds = function(filter) {
            currentFilter = filter;
            displayMarketplace();
        }

        function displayMarketplace() {
            let filtered = builds;
            
            if (currentFilter !== 'All' && currentFilter !== 'My Builds') {
                filtered = builds.filter(b => b.game === currentFilter);
            } else if (currentFilter === 'My Builds') {
                if (!currentUser) {
                    document.getElementById('marketplace').innerHTML = '<p>Login first</p>';
                    return;
                }
                filtered = builds.filter(b => b.seller === currentUser.username);
            }
            
            if (filtered.length === 0) {
                document.getElementById('marketplace').innerHTML = '<p>No builds</p>';
                return;
            }
            
            let html = '';
            filtered.forEach(b => {
                const canDelete = currentUser && (currentUser.role === 'owner' || currentUser.role === 'moderator' || b.seller === currentUser.username);
                
                html += `
                    <div class="build-card">
                        <h3>${b.title}</h3>
                        <div>${b.game}</div>
                        <div class="build-price">üí∞ ${b.price}</div>
                        <p>${b.desc}</p>
                        <div>üì¶ ${b.file}</div>
                        <div>Seller: ${b.seller}</div>
                        <button class="download-btn" onclick="downloadBuild(${b.id}, '${b.file}')">DOWNLOAD</button>
                        ${canDelete ? `<button class="delete-btn" onclick="deleteBuild(${b.id})">DELETE</button>` : ''}
                    </div>
                `;
            });
            
            document.getElementById('marketplace').innerHTML = html;
        }

        // ========== INIT ==========
        initFingerprint();
        displayChat();
        displayMarketplace();
    </script>
</body>
</html>
