<!DOCTYPE html>
<html>
<head>
    <title>OXYX MARKET | SHADOW EDITION</title>
    <style>
        /* 3D Shadow Theme inspired by Cid Kagenou */
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        * { 
            margin:0; 
            padding:0; 
            box-sizing:border-box; 
            font-family:'Orbitron',monospace; 
        }
        
        body { 
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0a2a 50%, #0a0a0a 100%);
            color:#e0e0e0; 
            padding:20px; 
            min-height:100vh;
            position:relative;
            overflow-x:hidden;
        }
        
        /* Animated Chain Effects */
        .chain-left, .chain-right {
            position: fixed;
            top: 0;
            width: 60px;
            height: 100vh;
            z-index: 1000;
            opacity: 0.4;
        }
        
        .chain-left { 
            left: 0; 
            background: repeating-linear-gradient(
                0deg,
                #333 0px,
                #333 15px,
                #666 15px,
                #666 30px
            );
            animation: chainMove 3s ease-in-out infinite;
        }
        
        .chain-right { 
            right: 0; 
            background: repeating-linear-gradient(
                0deg,
                #666 0px,
                #666 15px,
                #333 15px,
                #333 30px
            );
            animation: chainMove 3s ease-in-out infinite reverse;
        }
        
        @keyframes chainMove {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        .container { 
            max-width:1400px; 
            margin:0 auto; 
            position:relative;
            z-index:10;
        }
        
        h1 { 
            font-size:4.5em; 
            text-align:center; 
            background: linear-gradient(45deg, #b300ff, #ff00ff, #00ffff, #b300ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(179,0,255,0.5);
            margin-bottom:20px;
            font-weight:900;
            position:relative;
            animation: shadowPulse 2s ease-in-out infinite;
        }
        
        @keyframes shadowPulse {
            0%, 100% { text-shadow: 0 0 30px rgba(179,0,255,0.5); }
            50% { text-shadow: 0 0 50px rgba(179,0,255,0.8), 0 0 80px rgba(255,0,255,0.3); }
        }
        
        .powered-by {
            text-align:center;
            font-size:0.9em;
            color:#666;
            margin-bottom:30px;
            font-style:italic;
        }
        
        .card { 
            background: linear-gradient(145deg, #1a1a2a, #2a1a3a);
            border:2px solid #b300ff; 
            border-radius:20px; 
            padding:25px; 
            margin-bottom:25px;
            box-shadow: 
                0 8px 32px rgba(179,0,255,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1);
            position:relative;
            backdrop-filter: blur(10px);
            transform: perspective(1000px) rotateX(2deg);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: perspective(1000px) rotateX(0deg) translateY(-5px);
            box-shadow: 0 15px 40px rgba(179,0,255,0.4);
        }
        
        .card::before {
            content:'';
            position:absolute;
            top:-2px; left:-2px; right:-2px; bottom:-2px;
            background: linear-gradient(45deg, #b300ff, #ff00ff, #00ffff, #b300ff);
            border-radius:22px;
            z-index:-1;
            opacity:0.7;
            animation: borderGlow 3s ease-in-out infinite;
        }
        
        @keyframes borderGlow {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }
        
        .stats { 
            display:grid; 
            grid-template-columns:repeat(3,1fr); 
            gap:20px; 
            margin:25px 0; 
        }
        
        .stat-card { 
            background: linear-gradient(145deg, #2a0a3a, #3a1a4a);
            border:2px solid gold; 
            border-radius:15px; 
            padding:20px; 
            text-align:center;
            box-shadow: 0 4px 20px rgba(255,215,0,0.3);
            transition: transform 0.3s ease;
            transform: perspective(800px) rotateY(-5deg);
        }
        
        .stat-card:hover {
            transform: perspective(800px) rotateY(0deg) translateY(-8px);
            box-shadow: 0 8px 30px rgba(255,215,0,0.5);
        }
        
        .stat-value { 
            font-size:3em; 
            color:gold; 
            font-weight:900;
            text-shadow: 0 0 20px rgba(255,215,0,0.5);
            animation: numberGlow 2s ease-in-out infinite;
        }
        
        @keyframes numberGlow {
            0%, 100% { text-shadow: 0 0 20px rgba(255,215,0,0.5); }
            50% { text-shadow: 0 0 30px rgba(255,215,0,0.8); }
        }
        
        .online-dot { 
            display:inline-block; 
            width:12px; 
            height:12px; 
            background:#00ff00; 
            border-radius:50%; 
            animation:pulse 2s infinite;
            box-shadow: 0 0 10px #00ff00;
        }
        
        @keyframes pulse { 
            0%{opacity:1; transform:scale(1)} 
            50%{opacity:0.5; transform:scale(1.3)} 
            100%{opacity:1; transform:scale(1)}
        }
        
        .login-grid { 
            display:grid; 
            grid-template-columns:1fr 1fr; 
            gap:25px; 
        }
        
        input, textarea, select { 
            width:100%; 
            padding:15px; 
            margin:10px 0; 
            background: linear-gradient(145deg, #2a2a3a, #3a3a4a);
            border:2px solid #b300ff; 
            border-radius:10px; 
            color:#e0e0e0;
            font-family:'Orbitron',monospace;
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.3);
        }
        
        input:focus, textarea:focus {
            border-color:#ff00ff;
            box-shadow: 0 0 20px rgba(255,0,255,0.3), inset 0 2px 5px rgba(0,0,0,0.3);
            outline:none;
            transform: translateY(-2px);
        }
        
        button { 
            width:100%; 
            padding:18px; 
            background: linear-gradient(45deg, #b300ff, #d400ff);
            border:none; 
            border-radius:10px; 
            color:white; 
            font-weight:bold; 
            cursor:pointer;
            font-family:'Orbitron',monospace;
            transition: all 0.3s ease;
            text-transform:uppercase;
            letter-spacing:1px;
            box-shadow: 0 4px 15px rgba(179,0,255,0.3);
            transform: perspective(500px) rotateX(10deg);
        }
        
        button:hover { 
            background: linear-gradient(45deg, #d400ff, #ff00ff);
            transform: perspective(500px) rotateX(0deg) translateY(-3px);
            box-shadow: 0 8px 25px rgba(179,0,255,0.5);
        }
        
        .ip-table { 
            width:100%; 
            border-collapse:collapse; 
            margin-top:20px;
            background: linear-gradient(145deg, #1a1a2a, #2a2a3a);
            border-radius:10px;
            overflow:hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }
        
        .ip-table th { 
            background: linear-gradient(45deg, #b300ff, #d400ff);
            padding:15px; 
            text-align:left;
            font-weight:bold;
            text-transform:uppercase;
            letter-spacing:1px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        
        .ip-table td { 
            padding:12px; 
            border-bottom:1px solid #333;
            transition: all 0.3s ease;
        }
        
        .ip-table tr:hover td {
            background: rgba(179,0,255,0.1);
            transform: translateX(5px);
        }
        
        .hidden { display:none !important; }
        
        /* Enhanced Security Styles */
        .owner-panel { 
            background: linear-gradient(145deg, #1a0a2a, #2a1a3a);
            border:3px solid gold; 
            box-shadow: 0 0 30px rgba(255,215,0,0.3);
        }
        
        .mod-panel { 
            background: linear-gradient(145deg, #1a1a0a, #2a2a1a);
            border:3px solid #ffaa00; 
            box-shadow: 0 0 30px rgba(255,170,0,0.3);
        }
        
        .panel-tabs { 
            display:flex; 
            gap:15px; 
            margin-bottom:25px; 
            flex-wrap:wrap;
        }
        
        .tab-btn { 
            padding:12px 25px; 
            background: linear-gradient(145deg, #2a2a3a, #3a3a4a);
            border:2px solid #666; 
            border-radius:8px; 
            cursor:pointer;
            transition: all 0.3s ease;
            font-size:0.9em;
            transform: perspective(400px) rotateY(10deg);
        }
        
        .tab-btn.active { 
            background: linear-gradient(45deg, gold, #ffaa00);
            color:black; 
            border-color:gold;
            font-weight:bold;
            transform: perspective(400px) rotateY(0deg) translateY(-3px);
            box-shadow: 0 5px 15px rgba(255,215,0,0.4);
        }
        
        .tab-content { display:none; }
        .tab-content.active { display:block; }
        
        /* Chat Styles */
        .chat-container {
            height:200px;
            overflow-y:auto;
            background: linear-gradient(145deg, #0a0a1a, #1a1a2a);
            padding:15px;
            border-radius:10px;
            margin:15px 0;
            border:1px solid #333;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.5);
        }
        
        .chat-message {
            margin-bottom:8px;
            padding:8px;
            border-radius:5px;
            background: rgba(179,0,255,0.1);
            animation: messageSlide 0.3s ease-out;
        }
        
        @keyframes messageSlide {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .countdown {
            background: linear-gradient(45deg, #aa0000, #ff0000);
            color:white;
            padding:10px;
            border-radius:5px;
            text-align:center;
            margin:10px 0;
            font-weight:bold;
            animation: countdownPulse 1s ease-in-out infinite;
        }
        
        @keyframes countdownPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        /* Build Preview Styles */
        .build-preview {
            max-width:200px;
            max-height:150px;
            border-radius:10px;
            margin:10px 0;
            border:2px solid #b300ff;
            box-shadow: 0 4px 15px rgba(179,0,255,0.3);
        }
        
        .build-card {
            background: linear-gradient(145deg, #2a2a3a, #3a3a4a);
            border:2px solid #b300ff;
            border-radius:15px;
            padding:20px;
            transition: all 0.3s ease;
            transform: perspective(600px) rotateY(5deg);
        }
        
        .build-card:hover {
            transform: perspective(600px) rotateY(0deg) translateY(-8px);
            box-shadow: 0 15px 35px rgba(179,0,255,0.4);
        }
        
        .premium-build {
            border-color:gold;
            box-shadow: 0 0 25px rgba(255,215,0,0.4);
            background: linear-gradient(145deg, #3a2a0a, #4a3a1a);
        }
        
        /* Discord Links */
        .discord-links {
            display:flex;
            gap:15px;
            justify-content:center;
            margin:20px 0;
            flex-wrap:wrap;
        }
        
        .discord-btn {
            background: linear-gradient(45deg, #5865F2, #7289DA);
            padding:12px 25px;
            border-radius:25px;
            text-decoration:none;
            color:white;
            font-weight:bold;
            transition: all 0.3s ease;
            display:flex;
            align-items:center;
            gap:8px;
            transform: perspective(400px) rotateX(10deg);
            box-shadow: 0 4px 15px rgba(88,101,242,0.3);
        }
        
        .discord-btn:hover {
            transform: perspective(400px) rotateX(0deg) translateY(-5px);
            box-shadow: 0 8px 25px rgba(88,101,242,0.5);
        }
        
        /* Security Warning */
        .security-warning { 
            position:fixed; 
            top:0; left:0; 
            width:100%; height:100%; 
            background:rgba(0,0,0,0.95); 
            z-index:9999; 
            display:flex; 
            align-items:center; 
            justify-content:center;
        }
        
        .blocked-overlay {
            background: linear-gradient(45deg, #aa0000, #ff0000);
            padding:40px;
            border-radius:20px;
            text-align:center;
            box-shadow: 0 0 50px rgba(255,0,0,0.5);
            animation: warningPulse 1s ease-in-out infinite;
        }
        
        @keyframes warningPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* FAQ Styles */
        .faq-item {
            background: linear-gradient(145deg, #2a2a3a, #3a3a4a);
            margin:10px 0;
            border-radius:10px;
            overflow:hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transform: perspective(500px) rotateX(5deg);
            transition: all 0.3s ease;
        }
        
        .faq-item:hover {
            transform: perspective(500px) rotateX(0deg) translateY(-3px);
        }
        
        .faq-question {
            padding:15px;
            background: linear-gradient(45deg, #b300ff, #d400ff);
            cursor:pointer;
            font-weight:bold;
            transition: all 0.3s ease;
        }
        
        .faq-question:hover {
            background: linear-gradient(45deg, #d400ff, #ff00ff);
        }
        
        .faq-answer {
            padding:15px;
            display:none;
            animation: fadeIn 0.3s ease-out;
        }
        
        .faq-answer.active {
            display:block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .stats { grid-template-columns: 1fr; }
            .login-grid { grid-template-columns: 1fr; }
            .discord-links { flex-direction: column; align-items: center; }
            h1 { font-size: 2.5em; }
            .chain-left, .chain-right { width: 30px; }
        }
    </style>
</head>
<body>
    <!-- Animated Chain Effects -->
    <div class="chain-left"></div>
    <div class="chain-right"></div>
    
    <!-- Security Warning -->
    <div id="securityWarning" class="security-warning hidden">
        <div class="blocked-overlay">
            <h2>üö® SECURITY BREACH DETECTED</h2>
            <p>Unauthorized access attempt blocked.</p>
            <p id="blockMessage">This incident has been logged.</p>
            <div id="blockCountdown" class="countdown hidden"></div>
        </div>
    </div>

    <div class="container">
        <h1>‚ö° OXYX MARKET ‚ö°</h1>
        <div class="powered-by">Powered by OxyX ‚Ä¢ Shadow Edition</div>
        
        <!-- Discord Links -->
        <div class="discord-links">
            <a href="https://discord.gg/autobuild" class="discord-btn" target="_blank">
                üéÆ Main Server
            </a>
            <a href="https://discord.gg/boatbuilderhub" class="discord-btn" target="_blank">
                üõ†Ô∏è Support Server
            </a>
            <a href="https://discord.gg/boatbuilderhub" class="discord-btn" target="_blank">
                üí¨ Support Server 2
            </a>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-value" id="totalMembers">0</div>
                <div>Total Members</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="onlineNow">0</div>
                <div><span class="online-dot"></span> Online</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalBuilds">0</div>
                <div>Total Builds</div>
            </div>
        </div>

        <div id="deviceInfoSection" class="card">
            <h2>üì± DEVICE INFO</h2>
            <div style="background:#0a0a1a; padding:15px; border-radius:10px; font-family:monospace; box-shadow: inset 0 2px 10px rgba(0,0,0,0.5);">
                <p>Device ID: <span style="color:#00ff00;" id="deviceId">Loading...</span></p>
                <p id="ipDisplay" class="hidden">IP Address: <span style="color:#ffaa00;" id="ipAddress">Loading...</span></p>
            </div>
        </div>

        <div class="card">
            <h2>üîê LOGIN</h2>
            <div id="sessionWarning" class="hidden" style="background:#aa0000; padding:15px; border-radius:10px; text-align:center; margin-bottom:15px;">
                ‚ö†Ô∏è Akun aktif di device lain! 
                <button onclick="forceUnbind()" style="width:auto; padding:8px 15px; background:white; color:black; font-size:12px;">FORCE UNBIND (OWNER ONLY)</button>
            </div>
            <div class="login-grid" id="loginForm">
                <div>
                    <h3>üë§ MEMBER</h3>
                    <input type="text" id="memberUsername" placeholder="Username">
                    <button onclick="loginMember()">LOGIN MEMBER</button>
                </div>
                <div>
                    <h3>üëë ADMIN</h3>
                    <input type="text" id="adminUser" placeholder="Username">
                    <input type="password" id="adminPass" placeholder="Password">
                    <input type="text" id="whidInput" placeholder="WHID (Required for Admin)" style="background:#0a0a0a; border:2px solid gold;">
                    <button onclick="loginAdmin()">LOGIN ADMIN</button>
                </div>
            </div>
            <div id="userInfo" class="hidden" style="margin-top:25px; padding:20px; background:linear-gradient(145deg, #2a0a3a, #3a1a4a); border-radius:15px;">
                <p>Logged in as: <span id="displayName" style="font-weight:bold; color:gold;"></span></p>
                <button onclick="logout()" style="background:linear-gradient(45deg, #aa0000, #ff0000); margin-top:15px;">LOGOUT</button>
            </div>
        </div>

        <!-- Owner Panel -->
        <div id="ownerPanel" class="card owner-panel hidden">
            <h2>üëë OWNER COMMAND CENTER</h2>
            <div class="panel-tabs">
                <button class="tab-btn active" onclick="switchTab('users')">üë• USER TRACKING</button>
                <button class="tab-btn" onclick="switchTab('security')">üõ°Ô∏è SECURITY</button>
                <button class="tab-btn" onclick="switchTab('logs')">üìã ACTIVITY LOGS</button>
                <button class="tab-btn" onclick="switchTab('blacklist')">üö´ BLACKLIST</button>
                <button class="tab-btn" onclick="switchTab('modtools')">üîß MOD TOOLS</button>
            </div>

            <div id="usersTab" class="tab-content active">
                <div style="display:flex; gap:15px; margin-bottom:20px; flex-wrap:wrap;">
                    <button onclick="filterUsers('all')">ALL USERS</button>
                    <button onclick="filterUsers('members')">MEMBERS</button>
                    <button onclick="filterUsers('mods')">MODERATORS</button>
                    <button onclick="filterUsers('online')">ONLINE ONLY</button>
                </div>
                <table class="ip-table">
                    <thead>
                        <tr>
                            <th>Username</th>
                            <th>Role</th>
                            <th>IP Address</th>
                            <th>Device ID</th>
                            <th>Last Seen</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="userTrackingTable"></tbody>
                </table>
            </div>

            <div id="securityTab" class="tab-content">
                <div style="background:#aa0000; padding:15px; border-radius:10px; margin:15px 0;">
                    <h3>üö® SECURITY ALERTS</h3>
                    <div id="securityAlerts">No security issues detected.</div>
                </div>
                <h3>üîç IP Analysis</h3>
                <table class="ip-table">
                    <thead>
                        <tr>
                            <th>IP Address</th>
                            <th>Users Count</th>
                            <th>User List</th>
                            <th>Risk Level</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ipAnalysisTable"></tbody>
                </table>
            </div>

            <div id="logsTab" class="tab-content">
                <h3>üìã Recent Activity</h3>
                <div class="chat-container" style="height:350px;">
                    <div id="activityLogs"></div>
                </div>
                <button onclick="clearLogs()" style="background:linear-gradient(45deg, #aa0000, #ff0000); margin-top:15px;">CLEAR LOGS</button>
            </div>

            <div id="blacklistTab" class="tab-content">
                <h3>üö´ IP Blacklist Management</h3>
                <div style="margin-bottom:20px;">
                    <input type="text" id="blacklistIP" placeholder="IP Address to blacklist">
                    <button onclick="addToBlacklist()" style="background:linear-gradient(45deg, #aa0000, #ff0000);">ADD TO BLACKLIST</button>
                </div>
                <table class="ip-table">
                    <thead>
                        <tr>
                            <th>IP Address</th>
                            <th>Date Added</th>
                            <th>Reason</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="blacklistTable"></tbody>
                </table>
            </div>

            <div id="modtoolsTab" class="tab-content">
                <h3>üîß Moderator Management</h3>
                <div style="margin-bottom:20px;">
                    <h4>Reset Moderator Password</h4>
                    <select id="modSelect">
                        <option value="">Select Moderator</option>
                        <option value="helper_tester">helper_tester</option>
                        <option value="sigma">sigma</option>
                    </select>
                    <input type="password" id="newModPass" placeholder="New Password">
                    <button onclick="resetModPassword()">RESET PASSWORD</button>
                </div>
            </div>
        </div>

        <!-- Moderator Panel -->
        <div id="modPanel" class="card mod-panel hidden">
            <h2>üõ°Ô∏è MODERATOR CONTROL PANEL</h2>
            <div class="panel-tabs">
                <button class="tab-btn active" onclick="switchModTab('users')">üë• USER LIST</button>
                <button class="tab-btn" onclick="switchModTab('blacklist')">üö´ BLACKLIST</button>
                <button class="tab-btn" onclick="switchModTab('reports')">üìã REPORTS</button>
            </div>

            <div id="modUsersTab" class="tab-content active">
                <h3>üë• Member List</h3>
                <table class="ip-table">
                    <thead>
                        <tr>
                            <th>Username</th>
                            <th>IP Address</th>
                            <th>Last Seen</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="modUserTable"></tbody>
                </table>
            </div>

            <div id="modBlacklistTab" class="tab-content">
                <h3>üö´ IP Blacklist (Moderator)</h3>
                <div style="margin-bottom:20px;">
                    <input type="text" id="modBlacklistIP" placeholder="IP Address to blacklist">
                    <button onclick="modAddToBlacklist()" style="background:linear-gradient(45deg, #aa0000, #ff0000);">BLACKLIST IP</button>
                </div>
                <table class="ip-table">
                    <thead>
                        <tr>
                            <th>IP Address</th>
                            <th>Date Added</th>
                            <th>Added By</th>
                            <th>Reason</th>
                        </tr>
                    </thead>
                    <tbody id="modBlacklistTable"></tbody>
                </table>
            </div>

            <div id="modReportsTab" class="tab-content">
                <h3>üìã Security Reports</h3>
                <div class="chat-container">
                    <div id="modReports">No reports available.</div>
                </div>
            </div>
        </div>

        <!-- Enhanced Chat Section -->
        <div id="chatSection" class="card hidden">
            <h2>üí¨ STAFF CHAT</h2>
            <div id="chatCountdown" class="countdown hidden">
                Chat will be cleared in: <span id="chatTimer">180:00</span>
                <button onclick="clearChatNow()" style="margin-left:15px; padding:5px 15px; background:white; color:black;">CLEAR NOW</button>
            </div>
            <div class="chat-container">
                <div id="chatMessages"></div>
            </div>
            <input type="text" id="chatMsg" placeholder="Type message..." maxlength="200">
            <button onclick="sendChat()">SEND MESSAGE</button>
        </div>

        <!-- Enhanced Upload Section -->
        <div id="uploadSection" class="card hidden">
            <h2>üì§ UPLOAD BUILD</h2>
            <input type="text" id="buildName" placeholder="Build name" maxlength="50">
            <input type="number" id="buildPrice" min="0" value="0" placeholder="Price (100+ = premium)">
            <textarea id="buildDesc" rows="3" placeholder="Description" maxlength="200"></textarea>
            <input type="file" id="buildFile" accept=".build" required>
            <input type="file" id="buildImage" accept="image/*" placeholder="Build Preview Image (Optional)">
            <div id="imagePreview"></div>
            <button onclick="uploadBuild()">PUBLISH BUILD</button>
        </div>

        <!-- Enhanced Marketplace -->
        <div class="card">
            <h2>üè™ SHADOW MARKETPLACE</h2>
            <div style="display:flex; gap:15px; margin:20px 0; flex-wrap:wrap;">
                <button onclick="filterBuilds('all')">üìã ALL BUILDS</button>
                <button onclick="filterBuilds('free')">üÜì FREE BUILDS</button>
                <button onclick="filterBuilds('premium')">üíé PREMIUM BUILDS</button>
                <button onclick="filterBuilds('my')">üë§ MY BUILDS</button>
            </div>
            <div id="marketplace" style="display:grid; grid-template-columns:repeat(auto-fill,minmax(300px,1fr)); gap:20px;"></div>
        </div>

        <!-- FAQ & Bug Report Section -->
        <div class="card">
            <h2>‚ùì FAQ & BUG REPORT</h2>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:25px;">
                <div>
                    <h3>Frequently Asked Questions</h3>
                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFAQ(0)">How to upload builds?</div>
                        <div class="faq-answer">Only .build files are accepted. Add a preview image and description for better visibility.</div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFAQ(1)">What are premium builds?</div>
                        <div class="faq-answer">Builds priced 100+ Robux are premium builds with special highlighting.</div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFAQ(2)">How to become a moderator?</div>
                        <div class="faq-answer">Contact the owner through Discord servers for moderator applications.</div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFAQ(3)">What is WHID?</div>
                        <div class="faq-answer">WHID is a security identifier required for admin/moderator login to prevent unauthorized access.</div>
                    </div>
                </div>
                <div>
                    <h3>Report Bug</h3>
                    <input type="text" id="bugTitle" placeholder="Bug Title" maxlength="100">
                    <textarea id="bugDesc" rows="4" placeholder="Describe the bug in detail" maxlength="500"></textarea>
                    <select id="bugSeverity">
                        <option value="low">Low Priority</option>
                        <option value="medium">Medium Priority</option>
                        <option value="high">High Priority</option>
                        <option value="critical">Critical</option>
                    </select>
                    <button onclick="reportBug()">SUBMIT BUG REPORT</button>
                </div>
            </div>
        </div>

        <div style="text-align:center; color:#666; margin-top:40px; font-size:0.9em;">
            OXYX MARKET ‚Ä¢ Shadow Edition ‚Ä¢ Build A Boat Only<br>
            <span style="font-size:0.8em;">Powered by OxyX ‚Ä¢ Enhanced Security System</span>
        </div>
    </div>

    <script>
        // ========== ENHANCED SECURITY & ANTI-DEVTOOLS ==========
        let devtoolsOpen = false;
        let securityBreach = false;
        let blockedUntil = localStorage.getItem('blockedUntil');
        let failedAttempts = parseInt(localStorage.getItem('failedAttempts')) || 0;

        // Check if currently blocked
        if (blockedUntil && new Date() < new Date(blockedUntil)) {
            showBlockedScreen();
        }

        function showBlockedScreen() {
            document.getElementById('securityWarning').classList.remove('hidden');
            document.getElementById('blockMessage').innerText = 'Access blocked for 24 hours due to security violations.';
            
            let countdown = setInterval(() => {
                let now = new Date();
                let blocked = new Date(blockedUntil);
                let diff = blocked - now;
                
                if (diff <= 0) {
                    localStorage.removeItem('blockedUntil');
                    localStorage.removeItem('failedAttempts');
                    location.reload();
                    return;
                }
                
                let hours = Math.floor(diff / (1000 * 60 * 60));
                let minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                let seconds = Math.floor((diff % (1000 * 60)) / 1000);
                
                document.getElementById('blockCountdown').classList.remove('hidden');
                document.getElementById('blockCountdown').innerText = `Unblocked in: ${hours}h ${minutes}m ${seconds}s`;
            }, 1000);
        }

        // Enhanced DevTools Detection
        function detectDevTools() {
            let threshold = 160;
            if (window.outerHeight - window.innerHeight > threshold || 
                window.outerWidth - window.innerWidth > threshold) {
                if (!devtoolsOpen) {
                    devtoolsOpen = true;
                    securityBreach = true;
                    handleSecurityBreach('DevTools detected');
                }
            }
        }

        function handleSecurityBreach(reason) {
            failedAttempts++;
            localStorage.setItem('failedAttempts', failedAttempts);
            addLog('SECURITY_BREACH', reason);
            
            if (failedAttempts >= 3) {
                // Block for 24 hours
                let blockTime = new Date();
                blockTime.setHours(blockTime.getHours() + 24);
                localStorage.setItem('blockedUntil', blockTime.toISOString());
                showBlockedScreen();
            } else {
                // Just kick
                document.getElementById('securityWarning').classList.remove('hidden');
                document.getElementById('blockMessage').innerText = `Security violation detected. ${3 - failedAttempts} attempts remaining.`;
                setTimeout(() => {
                    window.location.href = 'about:blank';
                }, 3000);
            }
        }

        // Disable various developer access methods
        document.addEventListener('contextmenu', e => e.preventDefault());
        document.addEventListener('keydown', function(e) {
            if (e.key === 'F12' || 
                (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                (e.ctrlKey && e.shiftKey && e.key === 'J') ||
                (e.ctrlKey && e.key === 'U') ||
                (e.ctrlKey && e.shiftKey && e.key === 'C')) {
                e.preventDefault();
                handleSecurityBreach('Attempted to open DevTools via keyboard');
            }
        });

        setInterval(detectDevTools, 500);

        // ========== DATA & SETUP ==========
        let currentUser = null;
        let deviceId = localStorage.getItem('oxy_device_id') || 'OXYX-' + Math.random().toString(36).substring(2,10).toUpperCase();
        localStorage.setItem('oxy_device_id', deviceId);
        let activeSessions = JSON.parse(localStorage.getItem('activeSessions')) || {};
        let members = JSON.parse(localStorage.getItem('members')) || [];
        let builds = JSON.parse(localStorage.getItem('builds')) || [];
        let chats = JSON.parse(localStorage.getItem('chats')) || [];
        let activityLogs = JSON.parse(localStorage.getItem('activityLogs')) || [];
        let bannedUsers = JSON.parse(localStorage.getItem('bannedUsers')) || [];
        let blacklistedIPs = JSON.parse(localStorage.getItem('blacklistedIPs')) || [];
        let bugReports = JSON.parse(localStorage.getItem('bugReports')) || [];
        let currentIP = '';
        let chatClearTimer = null;
        let chatTimeLeft = 10800; // 3 hours in seconds

        // Enhanced WHID system with password reset capability
        let validWHIDs = JSON.parse(localStorage.getItem('validWHIDs')) || {
            'znyt': 'WHID-OWNER-7K9P2X8M4N6Q',
            'helper_tester': 'WHID-MOD-3F8H5J2L9R4T',
            'sigma': 'WHID-MOD-6B1N8K3P7W5Z'
        };

        let modPasswords = JSON.parse(localStorage.getItem('modPasswords')) || {
            'helper_tester': 'huwydhdjsiqo',
            'sigma': 'uBwbONeqIwYQ97'
        };

        document.getElementById('deviceId').innerText = deviceId;
        fetch('https://api.ipify.org?format=json')
            .then(r => r.json())
            .then(d => {
                currentIP = d.ip;
                document.getElementById('ipAddress').innerText = currentIP;
                
                if (blacklistedIPs.some(item => item.ip === currentIP)) {
                    alert('‚ùå Your IP has been blacklisted. Access denied.');
                    window.location.href = 'about:blank';
                    return;
                }
            });

        // ========== CHAT TIMER SYSTEM ==========
        function startChatTimer() {
            if (currentUser && (currentUser.role === 'owner' || currentUser.role === 'mod')) {
                document.getElementById('chatCountdown').classList.remove('hidden');
                
                chatClearTimer = setInterval(() => {
                    chatTimeLeft--;
                    let minutes = Math.floor(chatTimeLeft / 60);
                    let seconds = chatTimeLeft % 60;
                    document.getElementById('chatTimer').innerText = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                    
                    if (chatTimeLeft <= 0) {
                        clearChatAuto();
                    }
                }, 1000);
            }
        }

        function clearChatAuto() {
            chats = [];
            localStorage.setItem('chats', JSON.stringify(chats));
            displayChat();
            chatTimeLeft = 10800; // Reset to 3 hours
            addLog('AUTO_CLEAR_CHAT', 'Chat automatically cleared after 3 hours');
        }

        window.clearChatNow = function() {
            if (currentUser && (currentUser.role === 'owner' || currentUser.role === 'mod')) {
                if (confirm('Clear all chat messages now?')) {
                    chats = [];
                    localStorage.setItem('chats', JSON.stringify(chats));
                    displayChat();
                    chatTimeLeft = 10800; // Reset timer
                    addLog('MANUAL_CLEAR_CHAT', `Chat manually cleared by ${currentUser.username}`);
                }
            }
        };

        // ========== LOGGING SYSTEM ==========
        function addLog(action, details) {
            const log = {
                timestamp: new Date().toISOString(),
                user: currentUser ? currentUser.username : 'System',
                action: action,
                details: details,
                ip: currentIP,
                deviceId: deviceId
            };
            activityLogs.unshift(log);
            if (activityLogs.length > 500) activityLogs.pop();
            localStorage.setItem('activityLogs', JSON.stringify(activityLogs));
            if (currentUser && (currentUser.role === 'owner' || currentUser.role === 'mod')) {
                updateActivityLogs();
            }
        }

        // ========== CORE FUNCTIONS ==========
        window.forceUnbind = function() {
            let user = document.getElementById('adminUser').value || document.getElementById('memberUsername').value;
            if(!user) return alert("Masukkan username di kotak login dulu!");
            if (currentUser && currentUser.role !== 'owner') return alert("‚ùå Only owner can force unbind!");
            
            delete activeSessions[user];
            localStorage.setItem('activeSessions', JSON.stringify(activeSessions));
            document.getElementById('sessionWarning').classList.add('hidden');
            addLog('FORCE_UNBIND', `Forced unbind user: ${user}`);
            alert("‚úÖ Sesi " + user + " telah di-reset! Silahkan login kembali.");
        };

        window.loginMember = function() {
            if (securityBreach) return alert('‚ùå Security breach detected. Access denied.');
            
            let user = document.getElementById('memberUsername').value.trim();
            if (!user) return alert('Tolong masukkan username!');
            if (bannedUsers.includes(user)) return alert('‚ùå Akun anda telah dibanned!');
            if (blacklistedIPs.some(item => item.ip === currentIP)) return alert('‚ùå Your IP has been blacklisted!');
            
            if (activeSessions[user] && activeSessions[user] !== deviceId) {
                document.getElementById('sessionWarning').classList.remove('hidden');
                return;
            }
            loginFinalize(user, 'member');
        };

        window.loginAdmin = function() {
            if (securityBreach) return alert('‚ùå Security breach detected. Access denied.');
            
            let user = document.getElementById('adminUser').value.trim();
            let pass = document.getElementById('adminPass').value.trim();
            let whid = document.getElementById('whidInput').value.trim();
            
            if (bannedUsers.includes(user)) return alert('‚ùå Akun anda telah dibanned!');
            if (blacklistedIPs.some(item => item.ip === currentIP)) return alert('‚ùå Your IP has been blacklisted!');
            
            // Enhanced security check for unknown entities
            if (!validWHIDs[user]) {
                handleSecurityBreach(`Unknown entity attempted admin login: ${user}`);
                return;
            }
            
            if (!whid || validWHIDs[user] !== whid) {
                handleSecurityBreach(`Invalid WHID for user: ${user}`);
                return;
            }
            
            if (activeSessions[user] && activeSessions[user] !== deviceId) {
                document.getElementById('sessionWarning').classList.remove('hidden');
                return;
            }
            
            if (user === 'znyt' && pass === 'Root!Delta_7KpZ') {
                loginFinalize(user, 'owner');
            } else if (modPasswords[user] && modPasswords[user] === pass) {
                loginFinalize(user, 'mod');
            } else {
                handleSecurityBreach(`Failed admin login attempt: ${user}`);
            }
        };

        function loginFinalize(user, role) {
            currentUser = { username: user, role: role };
            activeSessions[user] = deviceId;
            localStorage.setItem('activeSessions', JSON.stringify(activeSessions));

            let now = new Date().toISOString();
            let idx = members.findIndex(m => m.username === user);
            
            if(idx > -1) {
                members[idx].lastSeen = now;
                members[idx].ip = currentIP;
                members[idx].role = role;
                members[idx].deviceId = deviceId;
            } else {
                members.push({
                    username: user, 
                    ip: currentIP, 
                    deviceId: deviceId, 
                    lastSeen: now,
                    role: role,
                    loginCount: 1
                });
            }
            localStorage.setItem('members', JSON.stringify(members));
            
            addLog('LOGIN', `User ${user} (${role}) logged in successfully`);
            showUserInfo();
            alert('‚úÖ Login Berhasil sebagai ' + role.toUpperCase());
        }

        function showUserInfo() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('sessionWarning').classList.add('hidden');
            document.getElementById('userInfo').classList.remove('hidden');
            document.getElementById('displayName').innerText = currentUser.username + ' (' + currentUser.role + ')';
            document.getElementById('uploadSection').classList.remove('hidden');
            document.getElementById('deviceInfoSection').style.display = 'block';
            
            if (currentUser.role === 'owner' || currentUser.role === 'mod') {
                document.getElementById('ipDisplay').classList.remove('hidden');
                document.getElementById('chatSection').classList.remove('hidden');
                displayChat();
                startChatTimer();
            }
            
            if (currentUser.role === 'owner') {
                document.getElementById('ownerPanel').classList.remove('hidden');
                updateOwnerPanel();
            } else if (currentUser.role === 'mod') {
                document.getElementById('modPanel').classList.remove('hidden');
                updateModPanel();
            }
        }

        window.logout = function() {
            if (currentUser) {
                addLog('LOGOUT', `User ${currentUser.username} logged out`);
                delete activeSessions[currentUser.username];
                localStorage.setItem('activeSessions', JSON.stringify(activeSessions));
            }
            if (chatClearTimer) clearInterval(chatClearTimer);
            location.reload();
        };

        // ========== OWNER PANEL FUNCTIONS ==========
        window.switchTab = function(tabName) {
            document.querySelectorAll('#ownerPanel .tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('#ownerPanel .tab-btn').forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName + 'Tab').classList.add('active');
            event.target.classList.add('active');
            
            if (tabName === 'users') updateUserTracking();
            if (tabName === 'security') updateSecurityAnalysis();
            if (tabName === 'logs') updateActivityLogs();
            if (tabName === 'blacklist') updateBlacklist();
        };

        window.switchModTab = function(tabName) {
            document.querySelectorAll('#modPanel .tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('#modPanel .tab-btn').forEach(btn => btn.classList.remove('active'));
            
            document.getElementById('mod' + tabName.charAt(0).toUpperCase() + tabName.slice(1) + 'Tab').classList.add('active');
            event.target.classList.add('active');
            
            if (tabName === 'users') updateModUserList();
            if (tabName === 'blacklist') updateModBlacklist();
        };

        function updateOwnerPanel() {
            updateUserTracking();
            updateSecurityAnalysis();
            updateActivityLogs();
            updateBlacklist();
        }

        function updateModPanel() {
            updateModUserList();
            updateModBlacklist();
        }

        window.filterUsers = function(filter) {
            updateUserTracking(filter);
        };

        function updateUserTracking(filter = 'all') {
            if (currentUser.role !== 'owner') return;
            
            let tbody = document.getElementById('userTrackingTable');
            let filteredMembers = members;
            
            if (filter === 'members') filteredMembers = members.filter(m => m.role === 'member');
            if (filter === 'mods') filteredMembers = members.filter(m => m.role === 'mod');
            if (filter === 'online') filteredMembers = members.filter(m => activeSessions[m.username]);
            
            tbody.innerHTML = filteredMembers.map(m => {
                let isOnline = activeSessions[m.username];
                let isBanned = bannedUsers.includes(m.username);
                
                return `<tr ${isBanned ? 'style="background:rgba(170,0,0,0.2);"' : ''}>
                    <td><b>${m.username}</b></td>
                    <td style="color:${m.role === 'owner' ? 'gold' : m.role === 'mod' ? '#ffaa00' : '#00ff00'}">${m.role.toUpperCase()}</td>
                    <td>${m.ip}</td>
                    <td>${m.deviceId.substring(0,10)}...</td>
                    <td>${new Date(m.lastSeen).toLocaleString()}</td>
                    <td style="color:${isOnline ? '#00ff00' : '#666'}">${isOnline ? '‚óè ONLINE' : '‚óã OFFLINE'}</td>
                    <td>
                        ${!isBanned ? 
                            `<button onclick="banUser('${m.username}')" style="background:#aa0000; padding:5px 10px; font-size:12px;">BAN</button>` : 
                            `<button onclick="unbanUser('${m.username}')" style="background:#00aa00; padding:5px 10px; font-size:12px;">UNBAN</button>`
                        }
                        <button onclick="kickUser('${m.username}')" style="background:#ff6600; padding:5px 10px; font-size:12px;">KICK</button>
                        <button onclick="blacklistIP('${m.ip}')" style="background:#660000; padding:5px 10px; font-size:12px;">BLACKLIST IP</button>
                    </td>
                </tr>`;
            }).join('');
        }

        function updateModUserList() {
            if (currentUser.role !== 'mod') return;
            
            let tbody = document.getElementById('modUserTable');
            let membersList = members.filter(m => m.role === 'member');
            
            tbody.innerHTML = membersList.map(m => {
                let isOnline = activeSessions[m.username];
                return `<tr>
                    <td><b>${m.username}</b></td>
                    <td>${m.ip}</td>
                    <td>${new Date(m.lastSeen).toLocaleString()}</td>
                    <td style="color:${isOnline ? '#00ff00' : '#666'}">${isOnline ? '‚óè ONLINE' : '‚óã OFFLINE'}</td>
                    <td>
                        <button onclick="modBlacklistUser('${m.username}', '${m.ip}')" style="background:#aa0000; padding:5px 10px; font-size:12px;">BLACKLIST</button>
                    </td>
                </tr>`;
            }).join('');
        }

        function updateSecurityAnalysis() {
            if (currentUser.role !== 'owner') return;
            
            let alerts = [];
            let ipGroups = {};
            
            members.forEach(m => {
                if (!ipGroups[m.ip]) ipGroups[m.ip] = [];
                ipGroups[m.ip].push(m);
            });
            
            Object.keys(ipGroups).forEach(ip => {
                if (ipGroups[ip].length > 1) {
                    alerts.push(`‚ö†Ô∏è Multiple accounts from IP ${ip}: ${ipGroups[ip].map(u => u.username).join(', ')}`);
                }
            });
            
            document.getElementById('securityAlerts').innerHTML = alerts.length ? 
                alerts.map(alert => `<div style="margin:5px 0; padding:8px; background:#330000; border-radius:5px;">${alert}</div>`).join('') :
                'No security issues detected.';
            
            let tbody = document.getElementById('ipAnalysisTable');
            tbody.innerHTML = Object.keys(ipGroups).map(ip => {
                let users = ipGroups[ip];
                let riskLevel = users.length > 1 ? 'HIGH' : 'LOW';
                let riskColor = users.length > 1 ? '#aa0000' : '#00aa00';
                
                return `<tr>
                    <td>${ip}</td>
                    <td>${users.length}</td>
                    <td>${users.map(u => `<span style="color:${u.role === 'owner' ? 'gold' : u.role === 'mod' ? '#ffaa00' : '#00ff00'}">${u.username}</span>`).join(', ')}</td>
                    <td style="color:${riskColor}">${riskLevel}</td>
                    <td>
                        <button onclick="investigateIP('${ip}')" style="background:#ff6600; padding:5px 10px; font-size:12px;">INVESTIGATE</button>
                        <button onclick="blacklistIP('${ip}')" style="background:#660000; padding:5px 10px; font-size:12px;">BLACKLIST</button>
                    </td>
                </tr>`;
            }).join('');
        }

        function updateActivityLogs() {
            if (currentUser.role !== 'owner') return;
            
            let logsDiv = document.getElementById('activityLogs');
            logsDiv.innerHTML = activityLogs.map(log => {
                let time = new Date(log.timestamp).toLocaleString();
                return `<div style="margin-bottom:10px; padding:8px; background:rgba(179,0,255,0.1); border-radius:5px;">
                    <span style="color:#666;">[${time}]</span> 
                    <span style="color:gold;">${log.user}</span> - 
                    <span style="color:#00ff00;">${log.action}</span>: 
                    ${log.details}
                    <span style="color:#666; float:right;">${log.ip}</span>
                </div>`;
            }).join('') || '<div style="color:#666;">No activity logs yet.</div>';
        }

        function updateBlacklist() {
            if (currentUser.role !== 'owner') return;
            
            let tbody = document.getElementById('blacklistTable');
            tbody.innerHTML = blacklistedIPs.map(item => {
                return `<tr>
                    <td>${item.ip}</td>
                    <td>${new Date(item.dateAdded).toLocaleString()}</td>
                    <td>${item.reason}</td>
                    <td>
                        <button onclick="removeFromBlacklist('${item.ip}')" style="background:#00aa00; padding:5px 10px; font-size:12px;">REMOVE</button>
                    </td>
                </tr>`;
            }).join('');
        }

        function updateModBlacklist() {
            if (currentUser.role !== 'mod') return;
            
            let tbody = document.getElementById('modBlacklistTable');
            tbody.innerHTML = blacklistedIPs.map(item => {
                return `<tr>
                    <td>${item.ip}</td>
                    <td>${new Date(item.dateAdded).toLocaleString()}</td>
                    <td>${item.addedBy}</td>
                    <td>${item.reason}</td>
                </tr>`;
            }).join('');
        }

        // ========== ADMIN ACTIONS ==========
        window.banUser = function(username) {
            if (currentUser.role !== 'owner') return alert('‚ùå Only owner can ban users!');
            if (confirm(`Ban user ${username}?`)) {
                bannedUsers.push(username);
                localStorage.setItem('bannedUsers', JSON.stringify(bannedUsers));
                if (activeSessions[username]) {
                    delete activeSessions[username];
                    localStorage.setItem('activeSessions', JSON.stringify(activeSessions));
                }
                addLog('BAN_USER', `Banned user: ${username}`);
                updateUserTracking();
                alert(`‚úÖ User ${username} telah dibanned!`);
            }
        };

        window.unbanUser = function(username) {
            if (currentUser.role !== 'owner') return alert('‚ùå Only owner can unban users!');
            if (confirm(`Unban user ${username}?`)) {
                bannedUsers = bannedUsers.filter(u => u !== username);
                localStorage.setItem('bannedUsers', JSON.stringify(bannedUsers));
                addLog('UNBAN_USER', `Unbanned user: ${username}`);
                updateUserTracking();
                alert(`‚úÖ User ${username} telah di-unban!`);
            }
        };

        window.kickUser = function(username) {
            if (currentUser.role !== 'owner') return alert('‚ùå Only owner can kick users!');
            if (confirm(`Kick user ${username}?`)) {
                if (activeSessions[username]) {
                    delete activeSessions[username];
                    localStorage.setItem('activeSessions', JSON.stringify(activeSessions));
                }
                addLog('KICK_USER', `Kicked user: ${username}`);
                updateUserTracking();
                alert(`‚úÖ User ${username} telah di-kick!`);
            }
        };

        window.blacklistIP = function(ip) {
            if (currentUser.role !== 'owner') return alert('‚ùå Only owner can blacklist IPs!');
            let reason = prompt('Reason for blacklisting this IP:') || 'No reason provided';
            if (confirm(`Blacklist IP ${ip}?`)) {
                blacklistedIPs.push({
                    ip: ip,
                    dateAdded: new Date().toISOString(),
                    reason: reason,
                    addedBy: currentUser.username
                });
                localStorage.setItem('blacklistedIPs', JSON.stringify(blacklistedIPs));
                
                members.filter(m => m.ip === ip).forEach(m => {
                    if (activeSessions[m.username]) {
                        delete activeSessions[m.username];
                    }
                });
                localStorage.setItem('activeSessions', JSON.stringify(activeSessions));
                
                addLog('BLACKLIST_IP', `Blacklisted IP: ${ip} - Reason: ${reason}`);
                updateBlacklist();
                updateUserTracking();
                alert(`‚úÖ IP ${ip} has been blacklisted!`);
            }
        };

        window.modBlacklistUser = function(username, ip) {
            if (currentUser.role !== 'mod') return alert('‚ùå Access denied!');
            let reason = prompt('Reason for blacklisting this IP:') || 'Moderator action';
            if (confirm(`Blacklist IP ${ip} (User: ${username})?`)) {
                blacklistedIPs.push({
                    ip: ip,
                    dateAdded: new Date().toISOString(),
                    reason: reason,
                    addedBy: currentUser.username
                });
                localStorage.setItem('blacklistedIPs', JSON.stringify(blacklistedIPs));
                
                if (activeSessions[username]) {
                    delete activeSessions[username];
                    localStorage.setItem('activeSessions', JSON.stringify(activeSessions));
                }
                
                addLog('MOD_BLACKLIST_IP', `Moderator ${currentUser.username} blacklisted IP: ${ip} (User: ${username})`);
                updateModUserList();
                updateModBlacklist();
                alert(`‚úÖ IP ${ip} has been blacklisted!`);
            }
        };

        window.modAddToBlacklist = function() {
            if (currentUser.role !== 'mod') return alert('‚ùå Access denied!');
            let ip = document.getElementById('modBlacklistIP').value.trim();
            if (!ip) return alert('Please enter an IP address!');
            
            let reason = prompt('Reason for blacklisting 
                                window.modAddToBlacklist = function() {
            if (currentUser.role !== 'mod') return alert('‚ùå Access denied!');
            let ip = document.getElementById('modBlacklistIP').value.trim();
            if (!ip) return alert('Please enter an IP address!');
            
            let reason = prompt('Reason for blacklisting:') || 'Moderator manual addition';
            blacklistedIPs.push({
                ip: ip,
                dateAdded: new Date().toISOString(),
                reason: reason,
                addedBy: currentUser.username
            });
            localStorage.setItem('blacklistedIPs', JSON.stringify(blacklistedIPs));
            document.getElementById('modBlacklistIP').value = '';
            addLog('MOD_BLACKLIST_IP', `Moderator manually blacklisted IP: ${ip}`);
            updateModBlacklist();
            alert(`‚úÖ IP ${ip} added to blacklist!`);
        };

        window.addToBlacklist = function() {
            if (currentUser.role !== 'owner') return alert('‚ùå Only owner can manage blacklist!');
            let ip = document.getElementById('blacklistIP').value.trim();
            if (!ip) return alert('Please enter an IP address!');
            
            let reason = prompt('Reason for blacklisting:') || 'Manual addition';
            blacklistedIPs.push({
                ip: ip,
                dateAdded: new Date().toISOString(),
                reason: reason,
                addedBy: currentUser.username
            });
            localStorage.setItem('blacklistedIPs', JSON.stringify(blacklistedIPs));
            document.getElementById('blacklistIP').value = '';
            addLog('BLACKLIST_IP', `Manually blacklisted IP: ${ip}`);
            updateBlacklist();
            alert(`‚úÖ IP ${ip} added to blacklist!`);
        };

        window.removeFromBlacklist = function(ip) {
            if (currentUser.role !== 'owner') return alert('‚ùå Only owner can manage blacklist!');
            if (confirm(`Remove IP ${ip} from blacklist?`)) {
                blacklistedIPs = blacklistedIPs.filter(item => item.ip !== ip);
                localStorage.setItem('blacklistedIPs', JSON.stringify(blacklistedIPs));
                addLog('UNBLACKLIST_IP', `Removed IP from blacklist: ${ip}`);
                updateBlacklist();
                alert(`‚úÖ IP ${ip} removed from blacklist!`);
            }
        };

        window.investigateIP = function(ip) {
            if (currentUser.role !== 'owner') return alert('‚ùå Only owner can investigate IPs!');
            let users = members.filter(m => m.ip === ip);
            let details = users.map(u => `${u.username} (${u.role}) - Last seen: ${new Date(u.lastSeen).toLocaleString()}`).join('\n');
            alert(`IP Investigation: ${ip}\n\nUsers:\n${details}`);
            addLog('IP_INVESTIGATION', `Investigated IP ${ip} with ${users.length} users`);
        };

        window.clearLogs = function() {
            if (currentUser.role !== 'owner') return alert('‚ùå Only owner can clear logs!');
            if (confirm('Clear all activity logs?')) {
                activityLogs = [];
                localStorage.setItem('activityLogs', JSON.stringify(activityLogs));
                updateActivityLogs();
                addLog('CLEAR_LOGS', 'Activity logs cleared');
            }
        };

        // ========== MODERATOR TOOLS ==========
        window.resetModPassword = function() {
            if (currentUser.role !== 'owner') return alert('‚ùå Only owner can reset moderator passwords!');
            
            let modUser = document.getElementById('modSelect').value;
            let newPass = document.getElementById('newModPass').value.trim();
            
            if (!modUser || !newPass) return alert('Please select moderator and enter new password!');
            if (newPass.length < 8) return alert('Password must be at least 8 characters!');
            
            if (confirm(`Reset password for moderator ${modUser}?`)) {
                modPasswords[modUser] = newPass;
                localStorage.setItem('modPasswords', JSON.stringify(modPasswords));
                
                // Force logout the moderator
                if (activeSessions[modUser]) {
                    delete activeSessions[modUser];
                    localStorage.setItem('activeSessions', JSON.stringify(activeSessions));
                }
                
                document.getElementById('newModPass').value = '';
                addLog('RESET_MOD_PASSWORD', `Reset password for moderator: ${modUser}`);
                alert(`‚úÖ Password reset for ${modUser}! They will need to login again.`);
            }
        };

        // ========== ENHANCED BUILD UPLOAD ==========
        window.uploadBuild = function() {
            if (!currentUser) return alert('Login dulu!');
            
            const file = document.getElementById('buildFile').files[0];
            const image = document.getElementById('buildImage').files[0];
            const name = document.getElementById('buildName').value.trim();
            const desc = document.getElementById('buildDesc').value.trim();
            const typeInput = document.getElementById('buildPrice').value;
            const price = parseInt(typeInput);

            if (!file) return alert("Tolong upload file build anda");
            if (file.name.split('.').pop().toLowerCase() !== 'build') return alert("Hanya file .build yang diperbolehkan!");
            if (!desc) return alert("Tolong tulis deskripsi build");
            if (!typeInput || isNaN(price)) return alert("Tolong pilih type build nya");
            if (!name) return alert("Tolong beri nama buildnya");

            let imageData = null;
            if (image) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imageData = e.target.result;
                    saveBuild();
                };
                reader.readAsDataURL(image);
            } else {
                saveBuild();
            }

            function saveBuild() {
                builds.push({ 
                    id: Date.now(), 
                    name: name, 
                    price: price, 
                    desc: desc, 
                    file: file.name, 
                    seller: currentUser.username,
                    type: price >= 100 ? 'premium' : 'non-premium',
                    image: imageData,
                    uploadDate: new Date().toISOString()
                });
                localStorage.setItem('builds', JSON.stringify(builds));
                
                // Clear form
                document.getElementById('buildName').value = '';
                document.getElementById('buildPrice').value = '0';
                document.getElementById('buildDesc').value = '';
                document.getElementById('buildFile').value = '';
                document.getElementById('buildImage').value = '';
                document.getElementById('imagePreview').innerHTML = '';
                
                let targetMarket = (price >= 100) ? "Premium Marketplace" : "Non-Premium Marketplace";
                addLog('UPLOAD_BUILD', `Uploaded build: ${name} (${price} Robux)`);
                alert(`‚úÖ Build telah sukses di publish dan mengarah marketplace untuk yang ${targetMarket}`);
                displayBuilds();
                updateStats();
            }
        };

        // Image preview functionality
        document.getElementById('buildImage').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('imagePreview').innerHTML = 
                        `<img src="${e.target.result}" class="build-preview" alt="Build Preview">`;
                };
                reader.readAsDataURL(file);
            }
        });

        window.displayBuilds = function(filter = 'all') {
            let container = document.getElementById('marketplace');
            let filtered = builds;
            if (filter === 'free') filtered = builds.filter(b => b.price === 0);
            if (filter === 'premium') filtered = builds.filter(b => b.price >= 100);
            if (filter === 'my') filtered = builds.filter(b => b.seller === currentUser?.username);

            container.innerHTML = filtered.length ? '' : '<p>Belum ada build.</p>';
            filtered.reverse().forEach(b => {
                let card = document.createElement('div');
                card.className = `build-card ${b.price >= 100 ? 'premium-build' : ''}`;
                
                let imageHtml = b.image ? 
                    `<img src="${b.image}" class="build-preview" alt="${b.name}">` : 
                    '<div style="height:150px; background:#333; border-radius:10px; display:flex; align-items:center; justify-content:center; color:#666;">No Preview</div>';
                
                card.innerHTML = `
                    ${imageHtml}
                    <h3>${b.name} ${b.price>=100?'üíé':''}</h3>
                    <p style="color:gold;">üí∞ ${b.price} Robux</p>
                    <p style="font-size:12px; color:#aaa; margin:10px 0;">${b.desc}</p>
                    <p style="font-size:10px; color:#666;">Seller: ${b.seller}</p>
                    <p style="font-size:10px; color:#666;">Uploaded: ${new Date(b.uploadDate).toLocaleDateString()}</p>
                    <button style="margin-top:15px; background:#00aa00; width:100%;" onclick="downloadBuild('${b.name}', '${b.file}')">‚¨áÔ∏è DOWNLOAD</button>
                `;
                container.appendChild(card);
            });
        };

        window.downloadBuild = function(name, file) {
            addLog('DOWNLOAD_BUILD', `Downloaded build: ${name}`);
            
            // Create download link simulation
            const link = document.createElement('a');
            link.href = '#';
            link.download = file;
            link.click();
            
            alert(`Downloading ${file}...`);
        };

        window.filterBuilds = (f) => displayBuilds(f);

        function updateStats() {
            document.getElementById('totalMembers').innerText = members.length;
            document.getElementById('totalBuilds').innerText = builds.length;
            document.getElementById('onlineNow').innerText = Object.keys(activeSessions).length;
        }

        function displayChat() {
            let messagesDiv = document.getElementById('chatMessages');
            messagesDiv.innerHTML = chats.map(c => 
                `<div class="chat-message">
                    <span style="color:${c.role==='owner'?'gold':c.role==='mod'?'#ffaa00':'#00ff00'}">[${c.user}]:</span> 
                    ${c.msg}
                    <span style="float:right; font-size:10px; color:#666;">${new Date(c.timestamp).toLocaleTimeString()}</span>
                </div>`
            ).join('');
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        window.sendChat = function() {
            let m = document.getElementById('chatMsg').value.trim();
            if(!m) return;
            
            chats.push({
                user: currentUser.username, 
                role: currentUser.role, 
                msg: m,
                timestamp: new Date().toISOString()
            });
            localStorage.setItem('chats', JSON.stringify(chats));
            document.getElementById('chatMsg').value = '';
            addLog('CHAT_MESSAGE', `Sent chat message`);
            displayChat();
        }

        // Enter key support for chat
        document.getElementById('chatMsg').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendChat();
            }
        });

        // ========== FAQ FUNCTIONS ==========
        window.toggleFAQ = function(index) {
            let answers = document.querySelectorAll('.faq-answer');
            let answer = answers[index];
            
            // Close all other answers
            answers.forEach((a, i) => {
                if (i !== index) a.classList.remove('active');
            });
            
            // Toggle current answer
            answer.classList.toggle('active');
        };

        // ========== BUG REPORT SYSTEM ==========
        window.reportBug = function() {
            let title = document.getElementById('bugTitle').value.trim();
            let desc = document.getElementById('bugDesc').value.trim();
            let severity = document.getElementById('bugSeverity').value;
            
            if (!title) return alert('Please enter a bug title!');
            if (!desc) return alert('Please describe the bug!');
            
            let bugReport = {
                id: Date.now(),
                title: title,
                description: desc,
                severity: severity,
                reporter: currentUser ? currentUser.username : 'Anonymous',
                reportDate: new Date().toISOString(),
                status: 'open'
            };
            
            bugReports.push(bugReport);
            localStorage.setItem('bugReports', JSON.stringify(bugReports));
            
            // Clear form
            document.getElementById('bugTitle').value = '';
            document.getElementById('bugDesc').value = '';
            document.getElementById('bugSeverity').value = 'low';
            
            addLog('BUG_REPORT', `Bug reported: ${title} (${severity})`);
            alert('‚úÖ Bug report submitted successfully! Thank you for helping improve OXYX Market.');
        };

        // ========== INITIALIZATION ==========
        function initializeApp() {
            updateStats();
            displayBuilds();
            
            // Security check on load
            if (securityBreach) {
                document.getElementById('securityWarning').classList.remove('hidden');
            }
            
            // Add some sample data if empty (for demo purposes)
            if (builds.length === 0) {
                builds.push({
                    id: 1,
                    name: "Shadow Destroyer",
                    price: 150,
                    desc: "Ultimate destroyer ship with shadow powers",
                    file: "shadow_destroyer.build",
                    seller: "SampleUser",
                    type: "premium",
                    image: null,
                    uploadDate: new Date().toISOString()
                });
                builds.push({
                    id: 2,
                    name: "Basic Boat",
                    price: 0,
                    desc: "Simple boat for beginners",
                    file: "basic_boat.build",
                    seller: "Helper",
                    type: "non-premium",
                    image: null,
                    uploadDate: new Date().toISOString()
                });
                localStorage.setItem('builds', JSON.stringify(builds));
            }
            
            displayBuilds();
            updateStats();
        }

        // Start the application
        initializeApp();

        // Auto-save session data every 30 seconds
        setInterval(() => {
            if (currentUser) {
                let idx = members.findIndex(m => m.username === currentUser.username);
                if (idx > -1) {
                    members[idx].lastSeen = new Date().toISOString();
                    localStorage.setItem('members', JSON.stringify(members));
                }
            }
        }, 30000);

        // Cleanup on page unload
        window.addEventListener('beforeunload', function() {
            if (chatClearTimer) {
                clearInterval(chatClearTimer);
            }
        });

        // Add some visual effects
        document.addEventListener('DOMContentLoaded', function() {
            // Add loading animation
            setTimeout(() => {
                document.body.style.opacity = '1';
            }, 100);
        });

        // Console warning for security
        console.log('%cSTOP!', 'color: red; font-size: 50px; font-weight: bold;');
        console.log('%cThis is a browser feature intended for developers. If someone told you to copy-paste something here, it is a scam and will give them access to your account.', 'color: red; font-size: 16px;');
        console.log('%cOXYX MARKET - Unauthorized access is prohibited', 'color: #b300ff; font-size: 14px; font-weight: bold;');

    </script>
</body>
</html>

                            
