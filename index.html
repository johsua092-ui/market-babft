<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OXYX MARKET - BUILD A BOAT</title>
    <script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        body {
            background: #0a0a0a;
            color: white;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #b300ff;
            font-size: 3em;
        }
        
        .discord-links {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }
        
        .discord-btn {
            padding: 10px 20px;
            background: #5865F2;
            color: white;
            text-decoration: none;
            border-radius: 5px;
        }
        
        .card {
            background: #1a1a2a;
            border: 2px solid #b300ff;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        /* LIVE STATS */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: #2a2a3a;
            border: 2px solid #b300ff;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: gold;
            line-height: 1.2;
        }
        
        .stat-label {
            color: #b07cff;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        .online-dot {
            display: inline-block;
            width: 10px;
            height: 10px;
            background: #00ff00;
            border-radius: 50%;
            margin-right: 5px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        .device-info {
            background: #0a0a1a;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .device-id {
            color: #00ff00;
            font-family: monospace;
            word-break: break-all;
        }
        
        .auth-section {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        
        .auth-section input {
            flex: 1;
            padding: 12px;
            background: #2a2a3a;
            border: 2px solid #b300ff;
            border-radius: 5px;
            color: white;
        }
        
        button {
            padding: 12px 25px;
            background: #b300ff;
            border: none;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }
        
        button:hover {
            background: #d400ff;
        }
        
        .user-info {
            background: #1a1a2a;
            border: 2px solid gold;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .role-badge {
            background: gold;
            color: black;
            padding: 5px 15px;
            border-radius: 20px;
        }
        
        /* IP TABLE */
        .ip-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .ip-table th {
            background: #b300ff;
            color: white;
            padding: 12px;
            text-align: left;
        }
        
        .ip-table td {
            padding: 10px;
            border-bottom: 1px solid #333;
        }
        
        .ip-table tr:hover {
            background: #2a2a3a;
        }
        
        .online-badge {
            color: #00ff00;
            font-weight: bold;
        }
        
        .offline-badge {
            color: #666;
        }
        
        .chat-box {
            background: #0a0a1a;
            border: 2px solid #b300ff;
            border-radius: 5px;
            padding: 15px;
            height: 150px;
            overflow-y: auto;
            margin: 10px 0;
        }
        
        .chat-message {
            padding: 5px;
            border-bottom: 1px solid #333;
        }
        
        .owner-text { color: gold; }
        .mod-text { color: #00ff00; }
        
        .form-group {
            margin: 15px 0;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            background: #2a2a3a;
            border: 2px solid #b300ff;
            border-radius: 5px;
            color: white;
        }
        
        .marketplace-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .build-card {
            background: #2a2a3a;
            border: 2px solid #b300ff;
            border-radius: 5px;
            padding: 15px;
        }
        
        .build-card.premium {
            border-color: gold;
            box-shadow: 0 0 20px gold;
        }
        
        .build-price {
            color: gold;
            font-size: 1.2em;
            margin: 10px 0;
        }
        
        .download-btn {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background: #00aa00;
        }
        
        .delete-btn {
            width: 100%;
            padding: 10px;
            background: #aa0000;
        }
        
        .hidden {
            display: none !important;
        }
        
        .footer {
            text-align: center;
            color: #666;
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ö° OXYX MARKET - BUILD A BOAT ‚ö°</h1>
        </div>

        <div class="discord-links">
            <a href="#" class="discord-btn">MAIN SERVER</a>
            <a href="#" class="discord-btn">TRADE SERVER</a>
            <a href="#" class="discord-btn">BUILDER SERVER</a>
        </div>

        <!-- LIVE STATS -->
        <div class="card">
            <h2>üìä LIVE MEMBERS</h2>
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-value" id="totalMembers">0</div>
                    <div class="stat-label">Total Members</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="onlineNow">0</div>
                    <div class="stat-label">
                        <span class="online-dot"></span> Online Now
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalBuilds">0</div>
                    <div class="stat-label">Total Builds</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalIPs">0</div>
                    <div class="stat-label">Unique IPs</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>üîê DEVICE FINGERPRINT</h2>
            <div class="device-info">
                <div>üñ•Ô∏è Device ID: <span class="device-id" id="deviceId">Loading...</span></div>
                <div>üìç IP Address: <span id="ipAddress">Detecting...</span></div>
            </div>
        </div>

        <div class="card">
            <h2>üîê MEMBER ACCESS</h2>
            
            <div class="auth-section">
                <input type="text" id="memberUsername" placeholder="Enter username">
                <button onclick="loginMember()">LOGIN</button>
            </div>
            
            <div class="auth-section">
                <input type="text" id="adminUser" placeholder="Admin">
                <input type="password" id="adminPass" placeholder="Password">
                <button onclick="loginAdmin()">ADMIN</button>
            </div>
            
            <div id="userInfo" class="user-info hidden">
                <span id="displayName"></span>
                <span class="role-badge" id="displayRole"></span>
                <button onclick="logout()">LOGOUT</button>
            </div>
        </div>

        <!-- ADMIN IP TABLE (Hanya untuk owner) -->
        <div id="ipTableSection" class="card hidden">
            <h2>üëë IP TRACKER - MEMBER DATABASE</h2>
            <table class="ip-table">
                <thead>
                    <tr>
                        <th>Username</th>
                        <th>IP Address</th>
                        <th>Device ID</th>
                        <th>Last Seen</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="ipTableBody">
                    <tr><td colspan="5">Loading...</td></tr>
                </tbody>
            </table>
        </div>

        <div id="chatSection" class="card hidden">
            <h2>üí¨ MOD CHAT</h2>
            <div class="chat-box" id="chatMessages"></div>
            <div style="display: flex; gap: 10px;">
                <input type="text" id="chatInput" placeholder="Type..." style="flex: 1; padding: 10px; background:#2a2a3a; border:2px solid #b300ff; color:white;">
                <button onclick="sendChat()">SEND</button>
            </div>
        </div>

        <div id="uploadSection" class="card hidden">
            <h2>üì§ UPLOAD BUILD (Build A Boat Only)</h2>
            <div class="form-group">
                <label>Title</label>
                <input type="text" id="buildTitle">
            </div>
            <div class="form-group">
                <label>Game</label>
                <select id="buildGame">
                    <option selected>Build A Boat</option>
                </select>
            </div>
            <div class="form-group">
                <label>Price (Robux) - Premium min 100</label>
                <input type="number" id="buildPrice" min="0" value="0">
            </div>
            <div class="form-group">
                <label>Description</label>
                <textarea id="buildDesc"></textarea>
            </div>
            <div class="form-group">
                <label>File (.build)</label>
                <input type="file" id="buildFile" accept=".build">
            </div>
            <button onclick="uploadBuild()">UPLOAD</button>
        </div>

        <div class="card">
            <h2>üè™ MARKETPLACE (Build A Boat)</h2>
            <div style="display: flex; gap: 10px; margin: 15px 0; flex-wrap: wrap;">
                <button onclick="filterBuilds('All')">üìã ALL</button>
                <button onclick="filterBuilds('Free')">üÜì FREE (0)</button>
                <button onclick="filterBuilds('Premium')">üíé PREMIUM (100+)</button>
                <button onclick="filterBuilds('My Builds')">üë§ MY BUILDS</button>
            </div>
            <div class="marketplace-grid" id="marketplace"></div>
        </div>

        <div class="footer">
            <p>OXYX MARKET ‚Ä¢ Build A Boat Only ‚Ä¢ 1 Owner ‚Ä¢ 1 Moderator ‚Ä¢ Real IP Tracking</p>
        </div>
    </div>

    <script>
        // ========== DATA REAL ==========
        let currentUser = null;
        let currentFilter = 'All';
        let deviceId = 'unknown';
        let clientIP = 'unknown';
        let members = JSON.parse(localStorage.getItem('members')) || [];
        
        let builds = JSON.parse(localStorage.getItem('builds')) || [
            { id: 1, title: "Dragon Boat", game: "Build A Boat", price: 0, desc: "Cool dragon boat", file: "dragon.build", seller: "owner" },
            { id: 2, title: "Flying Ship", game: "Build A Boat", price: 150, desc: "Flying ship with wings", file: "flying.build", seller: "mod1" },
            { id: 3, title: "Golden Raft", game: "Build A Boat", price: 200, desc: "Golden raft premium", file: "golden.build", seller: "member1" }
        ];
        
        let chats = [
            { user: "owner", role: "owner", msg: "Welcome mods!" }
        ];

        // ========== FINGERPRINT & IP ==========
        async function initFingerprint() {
            try {
                const fp = await FingerprintJS.load();
                const result = await fp.get();
                deviceId = result.visitorId;
                document.getElementById('deviceId').textContent = deviceId;
                
                const res = await fetch('https://api.ipify.org?format=json');
                const data = await res.json();
                clientIP = data.ip;
                document.getElementById('ipAddress').textContent = clientIP;
                
                // Auto update every 5 seconds
                setInterval(updateOnlineStatus, 5000);
            } catch (e) {
                console.log('Error:', e);
                document.getElementById('deviceId').textContent = 'DEVICE-' + Math.random().toString(36).substring(2, 10);
                document.getElementById('ipAddress').textContent = '127.0.0.1';
            }
        }

        // ========== LIVE STATS ==========
        function updateStats() {
            document.getElementById('totalMembers').textContent = members.length;
            document.getElementById('totalBuilds').textContent = builds.length;
            
            // Online now (last 5 minutes)
            const fiveMinAgo = Date.now() - 300000;
            const online = members.filter(m => new Date(m.lastSeen).getTime() > fiveMinAgo).length;
            document.getElementById('onlineNow').textContent = online;
            
            // Unique IPs
            const uniqueIPs = [...new Set(members.map(m => m.ip))].length;
            document.getElementById('totalIPs').textContent = uniqueIPs;
            
            // Update IP table if admin
            if (currentUser && currentUser.role === 'owner') {
                updateIpTable();
            }
        }

        function updateOnlineStatus() {
            if (currentUser) {
                // Update last seen for current user
                const member = members.find(m => m.username === currentUser.username);
                if (member) {
                    member.lastSeen = new Date().toISOString();
                    localStorage.setItem('members', JSON.stringify(members));
                }
            }
            updateStats();
        }

        // ========== IP TABLE (ONLY OWNER) ==========
        function updateIpTable() {
            const tbody = document.getElementById('ipTableBody');
            const fiveMinAgo = Date.now() - 300000;
            
            if (members.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5">No members yet</td></tr>';
                return;
            }
            
            let html = '';
            members.sort((a, b) => new Date(b.lastSeen) - new Date(a.lastSeen)).forEach(m => {
                const isOnline = new Date(m.lastSeen).getTime() > fiveMinAgo;
                const statusClass = isOnline ? 'online-badge' : 'offline-badge';
                const statusText = isOnline ? 'üü¢ Online' : '‚ö´ Offline';
                
                html += `
                    <tr>
                        <td><b>${m.username}</b></td>
                        <td>${m.ip || 'Unknown'}</td>
                        <td>${(m.deviceId || 'Unknown').substring(0, 15)}...</td>
                        <td>${new Date(m.lastSeen).toLocaleString()}</td>
                        <td class="${statusClass}">${statusText}</td>
                    </tr>
                `;
            });
            tbody.innerHTML = html;
        }

        // ========== AUTH ==========
        window.loginMember = function() {
            const username = document.getElementById('memberUsername').value.trim();
            if (!username) return alert('Enter username!');
            
            // Check if member exists
            let member = members.find(m => m.username === username);
            const now = new Date().toISOString();
            
            if (member) {
                member.lastSeen = now;
                member.loginCount = (member.loginCount || 0) + 1;
            } else {
                members.push({
                    username: username,
                    ip: clientIP,
                    deviceId: deviceId,
                    firstSeen: now,
                    lastSeen: now,
                    loginCount: 1
                });
            }
            localStorage.setItem('members', JSON.stringify(members));
            
            currentUser = { username: username, role: 'member' };
            document.getElementById('userInfo').classList.remove('hidden');
            document.getElementById('displayName').textContent = `üî• ${username}`;
            document.getElementById('displayRole').textContent = 'MEMBER';
            document.getElementById('uploadSection').classList.remove('hidden');
            updateStats();
            alert(`‚úÖ Welcome ${username}!`);
        }

        window.loginAdmin = function() {
            const user = document.getElementById('adminUser').value;
            const pass = document.getElementById('adminPass').value;
            
            if (user === 'owner' && pass === 'owner_oxyx_2026') {
                currentUser = { username: 'owner', role: 'owner' };
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('displayName').textContent = 'üëë owner';
                document.getElementById('displayRole').textContent = 'OWNER';
                document.getElementById('uploadSection').classList.remove('hidden');
                document.getElementById('chatSection').classList.remove('hidden');
                document.getElementById('ipTableSection').classList.remove('hidden');
                updateIpTable();
                alert('‚úÖ Welcome OWNER!');
            } 
            else if ((user === 'mod1' || user === 'mod2') && pass === 'mod123') {
                currentUser = { username: user, role: 'moderator' };
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('displayName').textContent = `üõ°Ô∏è ${user}`;
                document.getElementById('displayRole').textContent = 'MODERATOR';
                document.getElementById('uploadSection').classList.remove('hidden');
                document.getElementById('chatSection').classList.remove('hidden');
                alert(`‚úÖ Welcome ${user}!`);
            }
            else {
                alert('‚ùå Wrong credentials!');
            }
        }

        window.logout = function() {
            currentUser = null;
            document.getElementById('userInfo').classList.add('hidden');
            document.getElementById('uploadSection').classList.add('hidden');
            document.getElementById('chatSection').classList.add('hidden');
            document.getElementById('ipTableSection').classList.add('hidden');
            a
