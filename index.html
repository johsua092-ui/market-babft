<!DOCTYPE html>
<html>
<head>
    <title>OXYX Market</title>
    <style>
        body { background: black; color: white; font-family: Arial; padding: 20px; }
        .box { background: #1a1a2a; border: 2px solid purple; padding: 15px; margin: 10px 0; }
        input, button, select, textarea { padding: 8px; margin: 5px; width: 100%; }
        button { background: purple; color: white; cursor: pointer; }
        .chat-box { background: #0a0a1a; height: 150px; overflow: auto; padding: 10px; }
        .build-card { border: 1px solid purple; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>OXYX MARKET</h1>
    
    <!-- DISCORD -->
    <div class="box">
        <a href="https://discord.gg/autobuild" target="_blank">DISCORD MAIN</a> | 
        <a href="https://discord.gg/boatbuilderhub" target="_blank">DISCORD SUPPORT</a>
    </div>

    <!-- KEY SYSTEM SEDERHANA -->
    <div class="box">
        <h3>KEY</h3>
        <input type="text" id="keyInput" placeholder="owner / mod1 / mod2">
        <button onclick="activateKey()">AKTIVASI</button>
        <div id="keyStatus"></div>
    </div>

    <!-- MOD CHAT -->
    <div id="modPanel" style="display:none;" class="box">
        <h3>MOD CHAT</h3>
        <div class="chat-box" id="chatBox"></div>
        <input type="text" id="chatMsg" placeholder="Pesan">
        <button onclick="sendChat()">KIRIM</button>
    </div>

    <!-- UPLOAD BUILD -->
    <div class="box">
        <h3>UPLOAD BUILD</h3>
        <input type="text" id="name" placeholder="Nama"><br>
        <select id="type">
            <option value="Ship">Ship</option>
            <option value="Plane">Plane</option>
            <option value="Mech">Mech</option>
        </select><br>
        <input type="number" id="price" value="0" placeholder="Harga"><br>
        <textarea id="desc" placeholder="Deskripsi"></textarea><br>
        <input type="file" id="image" accept="image/*"><br>
        <input type="file" id="file" accept=".build"><br>
        <button onclick="publish()">PUBLISH</button>
        <div id="uploadStatus"></div>
    </div>

    <!-- SORTING -->
    <div>
        <button onclick="showAll()">Semua</button>
        <button onclick="showFree()">Gratis (0)</button>
        <button onclick="showPremium()">Premium (90-100)</button>
    </div>

    <!-- MARKETPLACE -->
    <div class="box" id="marketplace"></div>

    <script>
        // DATA SEDERHANA
        let builds = [];
        let chats = [];
        let isMod = false;
        let currentUser = '';
        
        // KEY VALID
        function activateKey() {
            let key = document.getElementById('keyInput').value;
            if (key === 'owner' || key === 'mod1' || key === 'mod2') {
                isMod = true;
                currentUser = key;
                document.getElementById('modPanel').style.display = 'block';
                document.getElementById('keyStatus').innerHTML = 'âœ… AKTIF';
                loadChats();
            } else {
                alert('KEY SALAH!');
            }
        }
        
        // CHAT
        function sendChat() {
            if (!isMod) return alert('Aktivasi dulu');
            let msg = document.getElementById('chatMsg').value;
            if (!msg) return;
            chats.push({ user: currentUser, msg: msg });
            document.getElementById('chatMsg').value = '';
            displayChats();
        }
        
        function displayChats() {
            let html = '';
            chats.forEach(c => html += `<b>${c.user}:</b> ${c.msg}<br>`);
            document.getElementById('chatBox').innerHTML = html;
        }
        
        function loadChats() { displayChats(); }
        
        // PUBLISH BUILD
        function publish() {
            let name = document.getElementById('name').value;
            let type = document.getElementById('type').value;
            let price = parseInt(document.getElementById('price').value);
            let desc = document.getElementById('desc').value;
            let image = document.getElementById('image').files[0];
            let file = document.getElementById('file').files[0];
            
            if (!name || !type || !desc || !image || !file) {
                alert('Isi semua!');
                return;
            }
            
            // Baca file gambar
            let imgReader = new FileReader();
            imgReader.onload = function(e) {
                let imageData = e.target.result;
                
                // Baca file build
                let fileReader = new FileReader();
                fileReader.onload = function(f) {
                    let fileData = f.target.result;
                    
                    builds.push({
                        name, type, price, desc,
                        image: imageData,
                        fileName: file.name,
                        fileData: fileData,
                        seller: isMod ? currentUser : 'Guest'
                    });
                    
                    alert('BUILD DIPUBLISH!');
                    document.getElementById('name').value = '';
                    document.getElementById('price').value = '0';
                    document.getElementById('desc').value = '';
                    document.getElementById('image').value = '';
                    document.getElementById('file').value = '';
                    
                    displayBuilds('all');
                };
                fileReader.readAsDataURL(file);
            };
            imgReader.readAsDataURL(image);
        }
        
        // DISPLAY BUILD
        function displayBuilds(filter) {
            let filtered = builds;
            if (filter === 'free') filtered = builds.filter(b => b.price === 0);
            if (filter === 'premium') filtered = builds.filter(b => b.price >= 90 && b.price <= 100);
            
            let html = '';
            filtered.forEach(b => {
                html += `
                    <div class="build-card">
                        <img src="${b.image}" style="max-width:100%; height:100px;"><br>
                        <b>${b.name}</b> (${b.type})<br>
                        Harga: ${b.price} Robux<br>
                        ${b.desc}<br>
                        <button onclick="download('${b.fileData}', '${b.fileName}')">DOWNLOAD</button><br>
                        Seller: ${b.seller}
                    </div>
                `;
            });
            document.getElementById('marketplace').innerHTML = html || 'Tidak ada build';
        }
        
        function download(data, name) {
            let a = document.createElement('a');
            a.href = data;
            a.download = name;
            a.click();
        }
        
        function showAll() { displayBuilds('all'); }
        function showFree() { displayBuilds('free'); }
        function showPremium() { displayBuilds('premium'); }
        
        // INIT
        displayBuilds('all');
    </script>
</body>
</html>
