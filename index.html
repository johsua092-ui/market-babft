<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>OXYX MARKET - SECURE</title>
    <!-- ANTI DEVELOPER TOOLS SUPER -->
    <script>
        // Blok semua shortcut berbahaya
        document.addEventListener('keydown', function(e) {
            if (e.key === 'F12' || 
                (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                (e.ctrlKey && e.shiftKey && e.key === 'J') ||
                (e.ctrlKey && e.key === 'u') ||
                (e.ctrlKey && e.key === 's') ||
                (e.ctrlKey && e.key === 'p') ||
                (e.ctrlKey && e.key === 'c' && !e.target.matches('input, textarea, button')) ||
                (e.ctrlKey && e.key === 'v' && !e.target.matches('input, textarea'))) {
                e.preventDefault();
                alert('üîí Akses developer tools diblokir!');
                return false;
            }
        });
        
        // Blok right click
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            alert('üîí Right click diblokir');
            return false;
        });
        
        // Deteksi DevTools (canggih)
        setInterval(function() {
            const start = performance.now();
            debugger;
            const end = performance.now();
            if (end - start > 100) {
                document.body.innerHTML = '<h1 style="color:red; text-align:center; margin-top:100px;">üîí DevTools terdeteksi! Halaman akan ditutup.</h1>';
                setTimeout(() => window.close(), 1000);
            }
        }, 1000);
    </script>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI',Arial,sans-serif; }
        body { background:#0a0a0a; color:white; padding:20px; }
        .container { max-width:1400px; margin:0 auto; }
        
        h1 { font-size:4em; text-align:center; color:#b300ff; text-shadow:3px 3px 0 #ff00ff,-3px -3px 0 #00ffff; margin-bottom:30px; }
        
        .card { background:#1a1a2a; border:2px solid #b300ff; border-radius:15px; padding:20px; margin-bottom:20px; }
        
        .stats { display:grid; grid-template-columns:repeat(4,1fr); gap:15px; margin:20px 0; }
        .stat-card { background:#2a0a3a; border:2px solid gold; border-radius:10px; padding:15px; text-align:center; }
        .stat-value { font-size:2.5em; color:gold; }
        .online-dot { display:inline-block; width:10px; height:10px; background:#00ff00; border-radius:50%; animation:pulse 2s infinite; }
        @keyframes pulse { 0%{opacity:1} 50%{opacity:0.5;transform:scale(1.3)} }
        
        #deviceInfoSection { display:none; }
        .admin-device { background:#0a0a1a; padding:10px; border-radius:5px; font-family:monospace; }
        .device-id { color:#00ff00; }
        .ip-addr { color:#ffaa00; }
        
        .login-grid { display:grid; grid-template-columns:1fr 1fr; gap:20px; }
        input { width:100%; padding:12px; margin:8px 0; background:#2a2a3a; border:2px solid #b300ff; border-radius:5px; color:white; }
        button { width:100%; padding:15px; background:#b300ff; border:none; border-radius:5px; color:white; font-weight:bold; cursor:pointer; }
        button:hover { background:#d400ff; }
        
        /* VERIFICATION CODE */
        .verify-section { background:#2a0a3a; border:2px solid gold; border-radius:10px; padding:15px; margin:15px 0; text-align:center; }
        .verify-code { font-size:2.5em; color:gold; font-weight:bold; letter-spacing:10px; }
        .verify-input { width:200px; margin:10px auto; text-align:center; font-size:1.5em; }
        
        .ip-table { width:100%; border-collapse:collapse; margin-top:15px; }
        .ip-table th { background:#b300ff; padding:12px; text-align:left; }
        .ip-table td { padding:10px; border-bottom:1px solid #333; }
        .online { color:#00ff00; }
        .offline { color:#666; }
        
        .ban-table { width:100%; border-collapse:collapse; margin-top:15px; }
        .ban-table th { background:#aa0000; padding:12px; text-align:left; }
        .ban-table td { padding:10px; border-bottom:1px solid #333; }
        .ban-btn { background:#aa0000; padding:5px 10px; width:auto; margin:0; }
        .unban-btn { background:#00aa00; padding:5px 10px; width:auto; margin:0; }
        
        .session-warning { background:#aa0000; padding:10px; border-radius:5px; text-align:center; }
        .hidden { display:none !important; }
        .footer { text-align:center; color:#666; margin-top:30px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö° OXYX MARKET ‚ö°</h1>
        
        <div class="stats">
            <div class="stat-card"><div class="stat-value" id="totalMembers">0</div><div>Total Members</div></div>
            <div class="stat-card"><div class="stat-value" id="onlineNow">0</div><div><span class="online-dot"></span> Online</div></div>
            <div class="stat-card"><div class="stat-value" id="totalBuilds">0</div><div>Total Builds</div></div>
            <div class="stat-card"><div class="stat-value" id="totalIPs">0</div><div>Unique IPs</div></div>
        </div>
        
        <div id="deviceInfoSection" class="card">
            <h2>üì± DEVICE INFO</h2>
            <div class="admin-device">
                <p>Device ID: <span class="device-id" id="deviceId">Loading...</span></p>
                <p>IP Address: <span class="ip-addr" id="ipAddress">Loading...</span></p>
            </div>
        </div>
        
        <div class="card" id="loginCard">
            <h2>üîê LOGIN</h2>
            <div class="login-grid">
                <div>
                    <h3>üë§ MEMBER</h3>
                    <input type="text" id="memberUsername" placeholder="Username">
                    <button id="loginMemberBtn">LOGIN MEMBER</button>
                </div>
                <div>
                    <h3>üëë ADMIN</h3>
                    <input type="text" id="adminUser" placeholder="Username">
                    <input type="password" id="adminPass" placeholder="Password">
                    <div id="verifySection" class="verify-section hidden">
                        <div class="verify-code" id="verifyCodeDisplay">123456</div>
                        <input type="text" id="verifyCodeInput" class="verify-input" placeholder="Masukkan kode" maxlength="6">
                        <button id="verifyCodeBtn" style="background:gold; color:black;">VERIFY</button>
                    </div>
                    <button id="loginAdminBtn">LOGIN ADMIN</button>
                </div>
            </div>
            
            <div id="sessionWarning" class="session-warning hidden">
                ‚ö†Ô∏è Account ini sudah aktif di device lain! Tidak bisa login.
            </div>
            
            <div id="userInfo" class="hidden" style="margin-top:20px; padding:15px; background:#2a0a3a; border-radius:10px;">
                <p>Logged in as: <span id="displayName"></span></p>
                <button id="logoutBtn" style="background:#aa0000;">LOGOUT</button>
            </div>
        </div>
        
        <!-- IP TRACKER (OWNER ONLY) - BISA LIHAT IP SEMUA ORANG -->
        <div id="ipTableSection" class="card hidden">
            <h2>üëë IP TRACKER</h2>
            <table class="ip-table">
                <thead><tr><th>Username</th><th>IP Address</th><th>Device ID</th><th>Last Seen</th><th>Status</th><th>Action</th></tr></thead>
                <tbody id="ipTableBody"></tbody>
            </table>
        </div>
        
        <!-- BANNED IPS (MOD & OWNER) -->
        <div id="banSection" class="card hidden">
            <h2>üö´ BANNED IPS</h2>
            <table class="ban-table">
                <thead><tr><th>IP Address</th><th>Username</th><th>Reason</th><th>Banned At</th><th>Action</th></tr></thead>
                <tbody id="banTableBody"></tbody>
            </table>
        </div>
        
        <div id="chatSection" class="card hidden">
            <h2>üí¨ MOD CHAT</h2>
            <div id="chatMessages" style="height:150px; overflow:auto; background:#0a0a1a; padding:10px; margin:10px 0;"></div>
            <input type="text" id="chatMsg" placeholder="Type message...">
            <button id="sendChatBtn">SEND</button>
        </div>
        
        <div id="uploadSection" class="card hidden">
            <h2>üì§ UPLOAD BUILD</h2>
            <input type="text" id="buildName" placeholder="Build name">
            <input type="number" id="buildPrice" min="0" value="0" placeholder="Price (100+ = premium)">
            <textarea id="buildDesc" rows="3" placeholder="Description"></textarea>
            <input type="file" id="buildFile" accept=".build">
            <button id="uploadBtn">PUBLISH</button>
        </div>
        
        <div class="card">
            <h2>üè™ MARKETPLACE</h2>
            <div style="display:flex; gap:10px; margin:15px 0; flex-wrap:wrap;">
                <button id="filterAll">üìã ALL</button>
                <button id="filterFree">üÜì FREE</button>
                <button id="filterPremium">üíé PREMIUM</button>
                <button id="filterMy">üë§ MY BUILDS</button>
            </div>
            <div id="marketplace" style="display:grid; grid-template-columns:repeat(auto-fill,minmax(250px,1fr)); gap:15px;"></div>
        </div>
        
        <div class="footer">OXYX MARKET ‚Ä¢ Build A Boat Only</div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ========== DATA ==========
            let currentUser = null;
            let currentFilter = 'all';
            let deviceId = 'DEVICE-' + Math.random().toString(36).substring(2,10).toUpperCase();
            let clientIP = '0.0.0.0';
            let pendingAdminLogin = null;
            
            let activeSessions = JSON.parse(localStorage.getItem('activeSessions')) || {};
            let members = JSON.parse(localStorage.getItem('members')) || [];
            let builds = JSON.parse(localStorage.getItem('builds')) || [
                {id:1, name:"Dragon Boat", price:0, desc:"Cool dragon boat", file:"dragon.build", seller:"znyt", fileData:null},
                {id:2, name:"Flying Ship", price:150, desc:"Flying ship", file:"flying.build", seller:"helper_tester", fileData:null},
                {id:3, name:"Golden Raft", price:200, desc:"Golden raft", file:"golden.build", seller:"sigma", fileData:null}
            ];
            let chats = JSON.parse(localStorage.getItem('chats')) || [{user:"znyt",role:"owner",msg:"Welcome!"}];
            let bannedIPs = JSON.parse(localStorage.getItem('bannedIPs')) || [];
            
            // ========== IP FIX ==========
            fetch('https://httpbin.org/ip')
                .then(res => res.json())
                .then(data => { 
                    clientIP = data.origin; 
                    document.getElementById('ipAddress').innerText = clientIP; 
                    
                    // Tambah ke members kalau belum ada
                    let existing = members.find(m => m.deviceId === deviceId);
                    if (!existing) {
                        members.push({ 
                            username: 'Guest', 
                            ip: clientIP, 
                            deviceId: deviceId, 
                            firstSeen: new Date().toISOString(), 
                            lastSeen: new Date().toISOString(),
                            loginCount: 0
                        });
                        localStorage.setItem('members', JSON.stringify(members));
                    }
                })
                .catch(() => { 
                    clientIP = '127.0.0.1'; 
                    document.getElementById('ipAddress').innerText = clientIP; 
                });
            
            document.getElementById('deviceId').innerText = deviceId;
            
            // ========== SESSION CHECK ==========
            function checkSession(username) {
                // Owner boleh login di device manapun
                if (username === 'znyt') return false;
                return activeSessions[username] && activeSessions[username] !== deviceId;
            }
            
            function setSession(username) {
                activeSessions[username] = deviceId;
                localStorage.setItem('activeSessions', JSON.stringify(activeSessions));
            }
            
            function clearSession(username) {
                delete activeSessions[username];
                localStorage.setItem('activeSessions', JSON.stringify(activeSessions));
            }
            
            // ========== GENERATE VERIFICATION CODE ==========
            function generateVerificationCode() {
                return Math.floor(100000 + Math.random() * 900000).toString();
            }
            
            // ========== LOGIN MEMBER ==========
            function loginMember() {
                let user = document.getElementById('memberUsername').value.trim();
                if (!user) { alert('Masukin nama!'); return; }
                
                if (checkSession(user)) { 
                    document.getElementById('sessionWarning').classList.remove('hidden');
                    alert('‚ùå Account sedang digunakan di device lain!'); 
                    return; 
                }
                
                let now = new Date().toISOString();
                let existing = members.find(m => m.username === user);
                if (existing) {
                    existing.lastSeen = now;
                    existing.ip = clientIP;
                    existing.deviceId = deviceId;
                    existing.loginCount = (existing.loginCount || 0) + 1;
                } else {
                    members.push({ username: user, ip: clientIP, deviceId: deviceId, firstSeen: now, lastSeen: now, loginCount: 1 });
                }
                setSession(user);
                localStorage.setItem('members', JSON.stringify(members));
                currentUser = { username: user, role: 'member' };
                showUserInfo();
                alert('‚úÖ Welcome ' + user);
            }
            
            // ========== LOGIN ADMIN (STEP 1) ==========
            function initiateAdminLogin() {
                let user = document.getElementById('adminUser').value.trim();
                let pass = document.getElementById('adminPass').value.trim();
                
                if (checkSession(user)) { 
                    document.getElementById('sessionWarning').classList.remove('hidden');
                    alert('‚ùå Account sedang digunakan di device lain!'); 
                    return; 
                }
                
                // Cek credentials
                let isValid = false;
                if (user === 'znyt' && pass === 'Root!Delta_7KpZ') isValid = true;
                else if (user === 'helper_tester' && pass === 'huwydhdjsiqo') isValid = true;
                else if (user === 'sigma' && pass === 'uBwbONeqIwYQ97') isValid = true;
                
                if (!isValid) {
                    alert('‚ùå Wrong credentials');
                    return;
                }
                
                // Generate verification code
                let code = generateVerificationCode();
                document.getElementById('verifyCodeDisplay').innerText = code;
                document.getElementById('verifySection').classList.remove('hidden');
                
                // Simpan pending login
                pendingAdminLogin = { username: user, role: user === 'znyt' ? 'owner' : 'mod' };
            }
            
            // ========== VERIFY CODE ==========
            function verifyCode() {
                if (!pendingAdminLogin) return;
                
                let inputCode = document.getElementById('verifyCodeInput').value.trim();
                let displayCode = document.getElementById('verifyCodeDisplay').innerText;
                
                if (inputCode === displayCode) {
                    // Login berhasil
                    let user = pendingAdminLogin.username;
                    let role = pendingAdminLogin.role;
                    
                    currentUser = { username: user, role: role };
                    setSession(user);
                    
                    let now = new Date().toISOString();
                    let existing = members.find(m => m.username === user);
                    if (existing) {
                        existing.lastSeen = now;
                        existing.ip = clientIP;
                        existing.deviceId = deviceId;
                    } else {
                        members.push({ username: user, ip: clientIP, deviceId: deviceId, firstSeen: now, lastSeen: now, loginCount: 1 });
                    }
                    localStorage.setItem('members', JSON.stringify(members));
                    
                    showUserInfo();
                    
                    if (role === 'owner') {
                        document.getElementById('ipTableSection').classList.remove('hidden');
                        document.getElementById('banSection').classList.remove('hidden');
                        document.getElementById('deviceInfoSection').style.display = 'block';
                        updateIpTable();
                        updateBanTable();
                        alert('‚úÖ Welcome OWNER');
                    } else {
                        document.getElementById('chatSection').classList.remove('hidden');
                        document.getElementById('banSection').classList.remove('hidden');
                        document.getElementById('deviceInfoSection').style.display = 'block';
                        updateBanTable();
                        alert('‚úÖ Welcome MOD');
                    }
                    
                    // Reset
                    document.getElementById('verifySection').classList.add('hidden');
                    document.getElementById('verifyCodeInput').value = '';
                    pendingAdminLogin = null;
                } else {
                    alert('‚ùå Kode verifikasi salah!');
                }
            }
            
            function showUserInfo() {
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('displayName').innerText = currentUser.username + ' (' + currentUser.role + ')';
                document.getElementById('uploadSection').classList.remove('hidden');
                if (currentUser.role === 'owner' || currentUser.role === 'mod') {
                    document.getElementById('chatSection').classList.remove('hidden');
                    displayChat();
                }
            }
            
            function logout() {
                if (currentUser) clearSession(currentUser.username);
                currentUser = null;
                pendingAdminLogin = null;
                document.getElementById('userInfo').classList.add('hidden');
                document.getElementById('uploadSection').classList.add('hidden');
                document.getElementById('chatSection').classList.add('hidden');
                document.getElementById('ipTableSection').classList.add('hidden');
                document.getElementById('banSection').classList.add('hidden');
                document.getElementById('deviceInfoSection').style.display = 'none';
                document.getElementById('verifySection').classList.add('hidden');
                document.getElementById('sessionWarning').classList.add('hidden');
                alert('Logged out');
            }
            
            // ========== STATS ==========
            function updateStats() {
                document.getElementById('totalMembers').innerText = members.length;
                document.getElementById('totalBuilds').inne
