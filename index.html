<!DOCTYPE html>
<html>
<head>
    <title>OXYX MARKET</title>
    <style>
        body { background: black; color: white; font-family: Arial; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .box { background: #1a1a2a; border: 2px solid purple; padding: 15px; margin: 10px 0; }
        input, button { width: 100%; padding: 10px; margin: 5px 0; }
        button { background: purple; color: white; border: none; cursor: pointer; }
        button:hover { background: #b87cff; }
        .hidden { display: none; }
        .build-card { border: 1px solid purple; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>OXYX MARKET</h1>
        
        <!-- DEVICE INFO -->
        <div class="box">
            <h3>DEVICE INFO</h3>
            <p>Device ID: <span id="deviceId">Loading...</span></p>
            <p>IP Address: <span id="ipAddress">Loading...</span></p>
        </div>
        
        <!-- MEMBER LOGIN -->
        <div class="box">
            <h3>MEMBER LOGIN</h3>
            <input type="text" id="memberName" placeholder="Username">
            <button onclick="memberLogin()">LOGIN</button>
        </div>
        
        <!-- ADMIN LOGIN -->
        <div class="box">
            <h3>ADMIN LOGIN</h3>
            <input type="text" id="adminUser" placeholder="Username">
            <input type="password" id="adminPass" placeholder="Password">
            <button onclick="adminLogin()">LOGIN</button>
        </div>
        
        <!-- USER INFO -->
        <div id="userInfo" class="box hidden">
            <p>Logged in as: <span id="displayName"></span></p>
            <button onclick="logout()">LOGOUT</button>
        </div>
        
        <!-- IP TRACKER -->
        <div id="ipTable" class="box hidden">
            <h3>IP TRACKER</h3>
            <div id="ipList"></div>
        </div>
        
        <!-- UPLOAD -->
        <div id="uploadBox" class="box hidden">
            <h3>UPLOAD BUILD</h3>
            <input type="text" id="buildName" placeholder="Build name">
            <input type="number" id="buildPrice" value="0" placeholder="Price">
            <textarea id="buildDesc" placeholder="Description"></textarea>
            <input type="file" id="buildFile" accept=".build">
            <button onclick="uploadBuild()">PUBLISH</button>
        </div>
        
        <!-- MARKETPLACE -->
        <div class="box">
            <h3>MARKETPLACE</h3>
            <div>
                <button onclick="showAll()">ALL</button>
                <button onclick="showFree()">FREE</button>
                <button onclick="showPremium()">PREMIUM</button>
                <button onclick="showMy()">MY BUILDS</button>
            </div>
            <div id="marketList"></div>
        </div>
    </div>
    
    <script>
        // ========== DATA SEDERHANA ==========
        let currentUser = null;
        let deviceId = 'DEVICE-' + Math.random().toString(36).substring(2,10);
        let clientIP = 'Unknown';
        let members = [];
        let builds = [
            {id:1, name:"Dragon Boat", price:0, desc:"Cool boat", file:"dragon.build", seller:"znyt"},
            {id:2, name:"Flying Ship", price:150, desc:"Flying ship", file:"flying.build", seller:"helper_tester"}
        ];
        
        // ========== IP ==========
        fetch('https://api.ipify.org?format=json')
            .then(r => r.json())
            .then(d => { clientIP = d.ip; document.getElementById('ipAddress').innerText = clientIP; })
            .catch(() => { clientIP = '127.0.0.1'; document.getElementById('ipAddress').innerText = clientIP; });
        
        document.getElementById('deviceId').innerText = deviceId;
        
        // ========== FUNGSI ==========
        window.memberLogin = function() {
            let name = document.getElementById('memberName').value;
            if (!name) { alert('Masukin nama!'); return; }
            
            members.push({ name: name, ip: clientIP, deviceId: deviceId });
            currentUser = { name: name, role: 'member' };
            
            document.getElementById('userInfo').classList.remove('hidden');
            document.getElementById('displayName').innerText = name + ' (MEMBER)';
            document.getElementById('uploadBox').classList.remove('hidden');
            alert('Welcome ' + name);
        };
        
        window.adminLogin = function() {
            let user = document.getElementById('adminUser').value;
            let pass = document.getElementById('adminPass').value;
            
            if (user === 'znyt' && pass === 'Root!Delta_7KpZ') {
                currentUser = { name: 'znyt', role: 'owner' };
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('displayName').innerText = 'znyt (OWNER)';
                document.getElementById('uploadBox').classList.remove('hidden');
                document.getElementById('ipTable').classList.remove('hidden');
                updateIpList();
                alert('Welcome OWNER');
            }
            else if (user === 'helper_tester' && pass === 'huwydhdjsiqo') {
                currentUser = { name: 'helper_tester', role: 'mod' };
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('displayName').innerText = 'helper_tester (MOD)';
                document.getElementById('uploadBox').classList.remove('hidden');
                alert('Welcome MOD 1');
            }
            else if (user === 'sigma' && pass === 'uBwbONeqIwYQ97') {
                currentUser = { name: 'sigma', role: 'mod' };
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('displayName').innerText = 'sigma (MOD)';
                document.getElementById('uploadBox').classList.remove('hidden');
                alert('Welcome MOD 2');
            }
            else {
                alert('Wrong password!');
            }
        };
        
        window.logout = function() {
            currentUser = null;
            document.getElementById('userInfo').classList.add('hidden');
            document.getElementById('uploadBox').classList.add('hidden');
            document.getElementById('ipTable').classList.add('hidden');
            alert('Logged out');
        };
        
        function updateIpList() {
            let list = document.getElementById('ipList');
            let html = '';
            members.forEach(m => {
                html += `<div>${m.name} - ${m.ip} - ${m.deviceId}</div>`;
            });
            list.innerHTML = html;
        }
        
        window.uploadBuild = function() {
            if (!currentUser) { alert('Login dulu!'); return; }
            
            let name = document.getElementById('buildName').value;
            let price = parseInt(document.getElementById('buildPrice').value) || 0;
            let desc = document.getElementById('buildDesc').value;
            let file = document.getElementById('buildFile').files[0];
            
            if (!name || !desc || !file) { alert('Isi semua!'); return; }
            
            builds.push({
                id: Date.now(),
                name: name,
                price: price,
                desc: desc,
                file: file.name,
                seller: currentUser.name
            });
            
            alert('Upload berhasil!');
            showAll();
        };
        
        window.downloadBuild = function(file) { alert('Download ' + file); };
        
        window.deleteBuild = function(id, seller) {
            if (!currentUser) { alert('Login dulu!'); return; }
            if (currentUser.role === 'owner' || currentUser.role === 'mod' || currentUser.name === seller) {
                builds = builds.filter(b => b.id !== id);
                showAll();
                alert('Build dihapus');
            } else { alert('Ga boleh hapus punya orang!'); }
        };
        
        window.showAll = function() { showBuilds(builds); };
        window.showFree = function() { showBuilds(builds.filter(b => b.price === 0)); };
        window.showPremium = function() { showBuilds(builds.filter(b => b.price >= 100)); };
        window.showMy = function() {
            if (!currentUser) { alert('Login dulu!'); return; }
            showBuilds(builds.filter(b => b.seller === currentUser.name));
        };
        
        function showBuilds(filtered) {
            let html = '';
            filtered.reverse().forEach(b => {
                let canDelete = currentUser && (currentUser.role === 'owner' || currentUser.role === 'mod' || currentUser.name === b.seller);
                html += `
                    <div class="build-card">
                        <h3>${b.name}</h3>
                        <p>ðŸ’° ${b.price}</p>
                        <p>${b.desc}</p>
                        <p>ðŸ“¦ ${b.file}</p>
                        <p>Seller: ${b.seller}</p>
                        <button onclick="downloadBuild('${b.file}')">DOWNLOAD</button>
                        ${canDelete ? `<button onclick="deleteBuild(${b.id}, '${b.seller}')" style="background:#aa0000;">DELETE</button>` : ''}
                    </div>
                `;
            });
            document.getElementById('marketList').innerHTML = html;
        }
        
        showAll();
    </script>
</body>
</html>
