<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>OXYX MARKET</title>
    <!-- ANTI DEVTOOLS SUPER -->
    <script>
        // Anti semua shortcut
        document.addEventListener('keydown', function(e) {
            if (e.key === 'F12' || 
                (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                (e.ctrlKey && e.shiftKey && e.key === 'J') ||
                (e.ctrlKey && e.key === 'u') ||
                (e.ctrlKey && e.key === 's') ||
                (e.ctrlKey && e.key === 'p')) {
                e.preventDefault();
                alert('üîí Akses ditolak!');
                return false;
            }
        });
        
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            alert('üîí Right click diblokir');
            return false;
        });
    </script>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI',Arial,sans-serif; }
        body { background:#0a0a0a; color:white; padding:20px; }
        .container { max-width:1400px; margin:0 auto; }
        
        h1 { font-size:4em; text-align:center; color:#b300ff; text-shadow:3px 3px 0 #ff00ff,-3px -3px 0 #00ffff; margin-bottom:30px; }
        
        .card { background:#1a1a2a; border:2px solid #b300ff; border-radius:15px; padding:20px; margin-bottom:20px; }
        
        /* DISCORD LINKS */
        .discord-links {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0 30px 0;
            flex-wrap: wrap;
        }
        .discord-btn {
            padding: 15px 30px;
            background: #5865F2;
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.1em;
            border: 2px solid #b300ff;
            transition: 0.3s;
            display: inline-block;
        }
        .discord-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px #5865F2;
        }
        
        /* STATS */
        .stats { display:grid; grid-template-columns:repeat(4,1fr); gap:15px; margin:20px 0; }
        .stat-card { background:#2a0a3a; border:2px solid gold; border-radius:10px; padding:15px; text-align:center; }
        .stat-value { font-size:2.5em; color:gold; }
        .online-dot { display:inline-block; width:10px; height:10px; background:#00ff00; border-radius:50%; animation:pulse 2s infinite; }
        @keyframes pulse { 0%{opacity:1} 50%{opacity:0.5;transform:scale(1.3)} }
        
        /* LOGIN GRID */
        .login-grid { display:grid; grid-template-columns:1fr 1fr; gap:20px; }
        input { width:100%; padding:12px; margin:8px 0; background:#2a2a3a; border:2px solid #b300ff; border-radius:5px; color:white; }
        button { width:100%; padding:15px; background:#b300ff; border:none; border-radius:5px; color:white; font-weight:bold; cursor:pointer; margin:5px 0; }
        button:hover { background:#d400ff; }
        
        /* DEVICE INFO */
        .device-info { background:#0a0a1a; padding:15px; border-radius:5px; font-family:monospace; margin-top:15px; }
        .device-id { color:#00ff00; }
        .ip-addr { color:#ffaa00; }
        
        /* IP TABLE */
        .ip-table { width:100%; border-collapse:collapse; margin-top:15px; }
        .ip-table th { background:#b300ff; padding:12px; text-align:left; }
        .ip-table td { padding:10px; border-bottom:1px solid #333; }
        .ip-table td button { padding:5px 10px; margin:0; background:#aa0000; border:none; color:white; border-radius:3px; cursor:pointer; }
        .online { color:#00ff00; }
        .offline { color:#666; }
        
        /* BAN LIST */
        .ban-table { width:100%; border-collapse:collapse; margin-top:15px; }
        .ban-table th { background:#aa0000; padding:12px; text-align:left; }
        .ban-table td { padding:10px; border-bottom:1px solid #333; }
        .ban-table td button { padding:5px 10px; margin:0; background:#00aa00; border:none; color:white; border-radius:3px; cursor:pointer; }
        
        /* CLEAR CHAT TIMER */
        .timer-section { background:#2a0a3a; border:2px solid gold; border-radius:10px; padding:15px; margin:15px 0; text-align:center; }
        .timer-display { font-size:2em; color:gold; font-weight:bold; }
        .timer-label { color:#b07cff; }
        
        /* MOD CHAT */
        .chat-box { background:#0a0a1a; border:2px solid #b300ff; border-radius:10px; padding:15px; height:150px; overflow-y:auto; margin:15px 0; }
        .chat-message { padding:5px; border-bottom:1px solid #333; }
        .owner-text { color:gold; }
        .mod-text { color:#00ff00; }
        
        /* MARKETPLACE */
        .build-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(250px,1fr)); gap:15px; margin-top:15px; }
        .build-card { background:#2a2a3a; border:2px solid #b300ff; border-radius:10px; padding:15px; }
        .build-card.premium { border-color:gold; }
        .build-price { color:gold; font-size:1.2em; margin:10px 0; }
        
        .hidden { display:none !important; }
        .footer { text-align:center; color:#666; margin-top:30px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö° OXYX MARKET ‚ö°</h1>
        
        <!-- DISCORD LINKS -->
        <div class="discord-links">
            <a href="https://discord.gg/autobuild" target="_blank" class="discord-btn">üîÆ MAIN SERVER</a>
            <a href="https://discord.gg/boatbuilderhub" target="_blank" class="discord-btn">‚ö° SUPPORT 1</a>
            <a href="https://discord.gg/boatbuilderhub" target="_blank" class="discord-btn">üéÆ SUPPORT 2</a>
        </div>
        
        <!-- STATS -->
        <div class="stats">
            <div class="stat-card"><div class="stat-value" id="totalMembers">0</div><div>Members</div></div>
            <div class="stat-card"><div class="stat-value" id="onlineNow">0</div><div><span class="online-dot"></span> Online</div></div>
            <div class="stat-card"><div class="stat-value" id="totalBuilds">0</div><div>Builds</div></div>
            <div class="stat-card"><div class="stat-value" id="totalIPs">0</div><div>IPs</div></div>
        </div>
        
        <!-- LOGIN -->
        <div class="card">
            <h2>üîê LOGIN</h2>
            <div class="login-grid">
                <div>
                    <h3>MEMBER</h3>
                    <input type="text" id="memberUsername" placeholder="Username">
                    <button id="loginMemberBtn">LOGIN MEMBER</button>
                </div>
                <div>
                    <h3>ADMIN</h3>
                    <input type="text" id="adminUser" placeholder="Username">
                    <input type="password" id="adminPass" placeholder="Password">
                    <button id="loginAdminBtn">LOGIN ADMIN</button>
                </div>
            </div>
            
            <!-- SESSION WARNING -->
            <div id="sessionWarning" class="hidden" style="background:#aa0000; padding:10px; border-radius:5px; text-align:center; margin:10px 0;">
                ‚ö†Ô∏è Account sudah aktif di device lain!
            </div>
            
            <!-- USER INFO -->
            <div id="userInfo" class="hidden" style="margin-top:15px; padding:15px; background:#2a0a3a; border-radius:10px;">
                <p>Logged in as: <span id="displayName"></span></p>
                <button id="logoutBtn">LOGOUT</button>
            </div>
            
            <!-- DEVICE INFO -->
            <div id="deviceInfo" class="device-info hidden"></div>
        </div>
        
        <!-- OWNER PANEL -->
        <div id="ownerPanel" class="card hidden">
            <h2>üëë OWNER PANEL</h2>
            
            <!-- CLEAR CHAT TIMER -->
            <div class="timer-section">
                <div class="timer-label">CHAT AUTO CLEAR</div>
                <div class="timer-display" id="chatTimer">03:00</div>
                <button id="resetTimerBtn" style="background:gold; color:black; margin-top:10px;">RESET TIMER</button>
                <button id="clearChatBtn" style="background:#aa0000; margin-top:10px;">CLEAR CHAT NOW</button>
            </div>
            
            <!-- IP TABLE -->
            <h3>üìã MEMBER LIST</h3>
            <table class="ip-table">
                <thead><tr><th>User</th><th>IP</th><th>Device</th><th>Status</th><th>Action</th></tr></thead>
                <tbody id="ipTableBody"></tbody>
            </table>
            
            <!-- BAN LIST -->
            <h3 style="margin-top:20px;">üö´ BANNED IPS</h3>
            <table class="ban-table">
                <thead><tr><th>IP Address</th><th>Reason</th><th>Banned At</th><th>Action</th></tr></thead>
                <tbody id="banTableBody"></tbody>
            </table>
        </div>
        
        <!-- MOD CHAT -->
        <div id="chatSection" class="card hidden">
            <h2>üí¨ MOD CHAT</h2>
            <div class="chat-box" id="chatMessages"></div>
            <input type="text" id="chatMsg" placeholder="Message...">
            <button id="sendChatBtn">SEND</button>
        </div>
        
        <!-- UPLOAD -->
        <div id="uploadSection" class="card hidden">
            <h2>üì§ UPLOAD BUILD</h2>
            <input type="text" id="buildName" placeholder="Build name">
            <input type="number" id="buildPrice" min="0" value="0" placeholder="Price">
            <textarea id="buildDesc" rows="3" placeholder="Description"></textarea>
            <input type="file" id="buildFile" accept=".build">
            <button id="uploadBtn">PUBLISH</button>
        </div>
        
        <!-- MARKETPLACE -->
        <div class="card">
            <h2>üè™ MARKETPLACE</h2>
            <div style="display:flex; gap:10px; margin:15px 0; flex-wrap:wrap;">
                <button id="filterAll">ALL</button>
                <button id="filterFree">FREE</button>
                <button id="filterPremium">PREMIUM</button>
                <button id="filterMy">MY BUILDS</button>
            </div>
            <div id="marketplace" class="build-grid"></div>
        </div>
        
        <div class="footer">OXYX MARKET ‚Ä¢ Build A Boat Only ‚Ä¢ 3 Discord Servers</div>
    </div>
    
    <script>
        // ========== DATA ==========
        let currentUser = null;
        let currentFilter = 'all';
        let deviceId = 'DEV-' + Math.random().toString(36).substring(2,10).toUpperCase();
        let clientIP = 'Unknown';
        let members = JSON.parse(localStorage.getItem('members')) || [];
        let builds = JSON.parse(localStorage.getItem('builds')) || [
            {id:1, name:"Dragon Boat", price:0, desc:"Cool dragon boat", file:"dragon.build", seller:"znyt", fileData:null},
            {id:2, name:"Flying Ship", price:150, desc:"Flying ship", file:"flying.build", seller:"helper_tester", fileData:null}
        ];
        let chats = JSON.parse(localStorage.getItem('chats')) || [];
        let activeSessions = JSON.parse(localStorage.getItem('activeSessions')) || {};
        let bannedIPs = JSON.parse(localStorage.getItem('bannedIPs')) || [];
        
        // Chat auto clear timer (3 jam = 180 menit)
        let chatClearInterval = 180 * 60 * 1000;
        let lastChatClear = parseInt(localStorage.getItem('lastChatClear')) || Date.now();
        let timerInterval = null;
        
        // ========== IP FIX ==========
        fetch('https://api.ipify.org?format=json')
            .then(r => r.json())
            .then(d => { clientIP = d.ip; updateDeviceInfo(); })
            .catch(() => { clientIP = '127.0.0.1'; updateDeviceInfo(); });
        
        function updateDeviceInfo() {
            let info = document.getElementById('deviceInfo');
            if (info) {
                info.innerHTML = `
                    <p>Device ID: <span class="device-id">${deviceId}</span></p>
                    <p>IP Address: <span class="ip-addr">${clientIP}</span></p>
                `;
            }
        }
        
        // ========== CHECK BANNED IP ==========
        function checkBannedIP() {
            return bannedIPs.some(b => b.ip === clientIP);
        }
        
        // ========== SESSION CHECK ==========
        function checkSession(user) {
            return activeSessions[user] && activeSessions[user] !== deviceId;
        }
        
        function setSession(user) {
            activeSessions[user] = deviceId;
            localStorage.setItem('activeSessions', JSON.stringify(activeSessions));
        }
        
        // ========== LOGIN FUNCTIONS ==========
        function loginMember() {
            if (checkBannedIP()) {
                alert('‚ùå IP Anda telah di-banned!');
                return;
            }
            
            let user = document.getElementById('memberUsername').value.trim();
            if (!user) { alert('Masukin username!'); return; }
            
            if (checkSession(user)) { 
                document.getElementById('sessionWarning').classList.remove('hidden');
                alert('‚ùå Akun dipakai device lain!'); 
                return; 
            }
            
            let now = new Date().toISOString();
            let exist = members.find(m => m.username === user);
            
            if (exist) {
                exist.lastSeen = now;
                exist.loginCount = (exist.loginCount || 0) + 1;
            } else {
                members.push({ username: user, ip: clientIP, deviceId: deviceId, firstSeen: now, lastSeen: now, loginCount: 1 });
            }
            
            setSession(user);
            localStorage.setItem('members', JSON.stringify(members));
            
            currentUser = { username: user, role: 'member' };
            document.getElementById('userInfo').classList.remove('hidden');
            document.getElementById('displayName').innerText = user + ' (MEMBER)';
            document.getElementById('uploadSection').classList.remove('hidden');
            alert('‚úÖ Welcome ' + user);
            updateStats();
        }
        
        function loginAdmin() {
            if (checkBannedIP()) {
                alert('‚ùå IP Anda telah di-banned!');
                return;
            }
            
            let user = document.getElementById('adminUser').value.trim();
            let pass = document.getElementById('adminPass').value.trim();
            
            if (checkSession(user)) { 
                document.getElementById('sessionWarning').classList.remove('hidden');
                alert('‚ùå Akun dipakai device lain!'); 
                return; 
            }
            
            if (user === 'znyt' && pass === 'Root!Delta_7KpZ') {
                currentUser = { username: 'znyt', role: 'owner' };
                setSession('znyt');
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('displayName').innerText = 'znyt (OWNER)';
                document.getElementById('uploadSection').classList.remove('hidden');
                document.getElementById('chatSection').classList.remove('hidden');
                document.getElementById('ownerPanel').classList.remove('hidden');
                document.getElementById('deviceInfo').classList.remove('hidden');
                startChatTimer();
                updateIpTable();
                updateBanTable();
                alert('‚úÖ Welcome OWNER');
            } else if (user === 'helper_tester' && pass === 'huwydhdjsiqo') {
                currentUser = { username: 'helper_tester', role: 'mod' };
                setSession('helper_tester');
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('displayName').innerText = 'helper_tester (MOD)';
                document.getElementById('uploadSection').classList.remove('hidden');
                document.getElementById('chatSection').classList.remove('hidden');
                document.getElementById('deviceInfo').classList.remove('hidden');
                alert('‚úÖ Welcome MOD 1');
            } else if (user === 'sigma' && pass === 'uBwbONeqIwYQ97') {
                currentUser = { username: 'sigma', role: 'mod' };
                setSession('sigma');
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('displayName').innerText = 'sigma (MOD)';
                document.getElementById('uploadSection').classList.remove('hidden');
                document.getElementById('chatSection').classList.remove('hidden');
                document.getElementById('deviceInfo').classList.remove('hidden');
                alert('‚úÖ Welcome MOD 2');
            } else {
                alert('‚ùå Wrong credentials');
            }
        }
        
        function logout() {
            if (currentUser) {
                delete activeSessions[currentUser.username];
                localStorage.setItem('activeSessions', JSON.stringify(activeSessions));
            }
            if (timerInterval) clearInterval(timerInterval);
            currentUser = null;
            document.getElementById('userInfo').classList.add('hidden');
            document.getElementById('uploadSection').classList.add('hidden');
            document.getElementById('chatSection').classList.add('hidden');
            document.getElementById('ownerPanel').classList.add('hidden');
            document.getElementById('deviceInfo').classList.add('hidden');
            document.getElementById('sessionWarning').classList.add('hidden');
            alert('Logged out');
        }
        
        // ========== CHAT TIMER ==========
        function startChatTimer() {
            if (timerInterval) clearInterval(timerInterval);
            
            function updateTimer() {
                let now = Date.now();
                let timeLeft = (lastChatClear + chatClearInterval) - now;
                
                if (timeLeft <= 0) {
                    chats = [];
                    localStorage.setItem('chats', JSON.stringify(chats));
                    lastChatClear = now;
                    localStorage.setItem('lastChatClear', lastChatClear);
                    displayChat();
                    timeLeft = chatClearInterval;
                }
                
                let minutes = Math.floor(timeLeft / 60000);
                let seconds = Math.floor((timeLeft % 60000) / 1000);
                let timerEl = document.getElementById('chatTimer');
                if (timerEl) {
                    timerEl.innerText = `${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;
                }
            }
            
            updateTimer();
            timerInterval = setInterval(updateTimer, 1000);
        }
        
        function resetChatTimer() {
            if (!currentUser || currentUser.role !== 'owner') {
                alert('‚ùå Only owner can reset timer!');
                return;
            }
            lastChatClear = Date.now();
            localStorage.setItem('lastChatClear', lastChatClear);
            alert('‚úÖ Chat timer reset!');
        }
        
        function manualClearChat() {
            if (!currentUser || currentUser.role !== 'owner') {
                alert('‚ùå Only owner can clear chat!');
                return;
            }
            chats = [];
            localStorage.setItem('chats', JSON.stringify(chats));
            lastChatClear = Date.now();
            localStorage.setItem('lastChatClear', lastChatClear);
            displayChat();
            alert('‚úÖ Chat cleared!');
        }
        
        // ========== BAN IP ==========
        function banIP(ip, username) {
            if (!currentUser || currentUser.role !== 'owner') {
                alert('‚ùå Only owner can ban IP!');
                return;
